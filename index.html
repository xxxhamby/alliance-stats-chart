<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alliance Stats</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #111827;
            color: #e5e7eb;
        }

        .card {
            background-color: #1f2937;
            border: 1px solid #374151;
        }

        .table-header th {
            padding: 8px 10px;
            position: sticky;
            top: 0;
            background-color: #1f2937;
            white-space: nowrap;
            cursor: pointer;
        }

        .table-row td {
            padding: 8px 10px;
            white-space: nowrap;
        }
        
        .table-row {
            cursor: pointer;
        }

        .btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .btn:disabled {
            cursor: not-allowed;
            opacity: 0.5;
        }

        .input-field {
            background-color: #374151;
            border: 1px solid #4b5563;
            color: #e5e7eb;
            padding: 6px 10px;
        }
        
        .stat-delta {
            font-size: 0.7rem;
            margin-left: 4px;
            font-weight: bold;
            cursor: pointer;
        }

        .history-entry {
            transition: background-color 0.2s;
        }
        .history-entry:hover {
            background-color: #374151;
        }

        .flag {
            cursor: pointer;
            opacity: 0.7;
            transition: all 0.2s ease-in-out;
        }
        .flag:hover, .flag.active {
            opacity: 1;
            transform: scale(1.1);
        }
    </style>
</head>

<body class="flex flex-col min-h-screen p-4 md:p-6 space-y-4">

    <!-- Header -->
    <header class="text-center flex-shrink-0 space-y-3">
        <div class="flex justify-between items-center">
            <button id="help-btn" class="bg-gray-700 hover:bg-gray-600 text-white font-bold p-3 rounded-md btn">
                <i class="fas fa-question-circle text-xl"></i>
            </button>
             <!-- This div is a spacer to balance the header -->
            <div class="w-12 h-12"></div>
        </div>

        <h1 class="text-4xl md:text-5xl font-extrabold text-white tracking-tight" data-translate-key="main_title">Alliance Stat Comparison</h1>
        
        <div id="language-switcher" class="flex justify-center space-x-3 pt-2">
            <img src="https://flagcdn.com/w40/us.png" class="flag h-6" title="English" data-lang="en">
            <img src="https://flagcdn.com/w40/es.png" class="flag h-6" title="EspaÃ±ol" data-lang="es">
            <img src="https://flagcdn.com/w40/cn.png" class="flag h-6" title="ä¸­æ–‡" data-lang="zh">
            <img src="https://flagcdn.com/w40/ph.png" class="flag h-6" title="Filipino" data-lang="tl">
            <img src="https://flagcdn.com/w40/sa.png" class="flag h-6" title="Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©" data-lang="ar">
            <img src="https://flagcdn.com/w40/pt.png" class="flag h-6" title="PortuguÃªs" data-lang="pt">
            <img src="https://flagcdn.com/w40/tr.png" class="flag h-6" title="TÃ¼rkÃ§e" data-lang="tr">
            <img src="https://flagcdn.com/w40/kr.png" class="flag h-6" title="í•œêµ­ì–´" data-lang="ko">
            <img src="https://flagcdn.com/w40/fr.png" class="flag h-6" title="FranÃ§ais" data-lang="fr">
            <img src="https://flagcdn.com/w40/ir.png" class="flag h-6" title="ÙØ§Ø±Ø³ÛŒ" data-lang="fa">
        </div>
    </header>

    <!-- Instructions -->
    <div class="card p-3 rounded-lg shadow-md flex-shrink-0">
        <h3 class="text-xl font-bold text-center text-yellow-400 mb-2" data-translate-key="instructions_title">Instructions & Info</h3>
        <ul class="text-lg font-bold text-gray-300 grid grid-cols-1 md:grid-cols-4 gap-x-4 text-center items-start">
            <li><i class="fas fa-file-medical text-4xl text-red-500 mb-2"></i><br><span data-translate-key="rule1">Rule 1: NO BUFFS active.</span></li>
            <li><i class="fas fa-crosshairs text-4xl text-blue-500 mb-2"></i><br><span data-translate-key="rule2">Rule 2: Test rally an alt with NO troops.</span></li>
            <li><i class="fas fa-users text-4xl text-purple-500 mb-2"></i><br><span data-translate-key="rule3">Rule 3: Use 4 Chenkos w/ lvl 5 Stand of Arms.</span></li>
            <li><i class="fas fa-calendar-check text-4xl text-green-500 mb-2"></i><br><span data-translate-key="rule4">Rule 4: Update at least once a week.</span></li>
        </ul>
    </div>

    <!-- Data Entry -->
    <div id="manual-entry" class="card p-4 rounded-lg shadow-lg flex-shrink-0">
        <form onsubmit="event.preventDefault(); handleSaveOrUpdate();">
            <div class="flex justify-between items-center mb-3">
                 <h2 class="text-lg font-semibold text-white" data-translate-key="entry_title">Manual Data Entry</h2>
                 <p class="text-xs text-gray-400 italic" data-translate-key="entry_tip">Tip: Use 'Tab' or 'Enter' to move through inputs in order.</p>
            </div>
            <div class="flex gap-4 items-end mb-3">
                <div class="flex-grow">
                    <label for="playerName" class="block text-sm font-medium text-gray-300 mb-1" data-translate-key="player_name">Player Name</label>
                    <input type="text" id="playerName" data-translate-key="player_name_placeholder" placeholder="Enter player name" required class="w-full rounded-md input-field">
                </div>
                <div class="flex items-end space-x-2 flex-shrink-0">
                    <button type="submit" id="submit-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-md btn">
                        <i class="fas fa-save mr-2 text-lg"></i><span data-translate-key="save_stats">Save Stats</span>
                    </button>
                    <button type="button" id="cancel-edit-btn" onclick="cancelEdit()" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-md btn hidden">
                        <i class="fas fa-times mr-2 text-lg"></i><span data-translate-key="cancel">Cancel</span>
                    </button>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-x-6">
                <!-- Unit Inputs -->
                <div class="space-y-2">
                    <h3 class="font-bold text-md text-center text-blue-400 flex items-center justify-center"><i class="fas fa-shield-alt mr-2"></i><span data-translate-key="infantry">Infantry</span> (%)</h3>
                    <div class="grid grid-cols-4 gap-2">
                        <input type="number" step="0.01" id="infAttack" placeholder="Att" required class="w-full rounded-md input-field text-center" title="Infantry Attack">
                        <input type="number" step="0.01" id="infDefense" placeholder="Def" required class="w-full rounded-md input-field text-center" title="Infantry Defense">
                        <input type="number" step="0.01" id="infLethality" placeholder="Let" required class="w-full rounded-md input-field text-center" title="Infantry Lethality">
                        <input type="number" step="0.01" id="infHp" placeholder="HP" required class="w-full rounded-md input-field text-center" title="Infantry Health">
                    </div>
                </div>
                <div class="space-y-2">
                    <h3 class="font-bold text-md text-center text-green-400 flex items-center justify-center"><i class="fas fa-horse mr-2"></i><span data-translate-key="cavalry">Cavalry</span> (%)</h3>
                    <div class="grid grid-cols-4 gap-2">
                        <input type="number" step="0.01" id="cavAttack" placeholder="Att" required class="w-full rounded-md input-field text-center" title="Cavalry Attack">
                        <input type="number" step="0.01" id="cavDefense" placeholder="Def" required class="w-full rounded-md input-field text-center" title="Cavalry Defense">
                        <input type="number" step="0.01" id="cavLethality" placeholder="Let" required class="w-full rounded-md input-field text-center" title="Cavalry Lethality">
                        <input type="number" step="0.01" id="cavHp" placeholder="HP" required class="w-full rounded-md input-field text-center" title="Cavalry Health">
                    </div>
                </div>
                <div class="space-y-2">
                    <h3 class="font-bold text-md text-center text-red-400 flex items-center justify-center"><i class="fas fa-bullseye mr-2"></i><span data-translate-key="archer">Archer</span> (%)</h3>
                    <div class="grid grid-cols-4 gap-2">
                        <input type="number" step="0.01" id="arcAttack" placeholder="Att" required class="w-full rounded-md input-field text-center" title="Archer Attack">
                        <input type="number" step="0.01" id="arcDefense" placeholder="Def" required class="w-full rounded-md input-field text-center" title="Archer Defense">
                        <input type="number" step="0.01" id="arcLethality" placeholder="Let" required class="w-full rounded-md input-field text-center" title="Archer Lethality">
                        <input type="number" step="0.01" id="arcHp" placeholder="HP" required class="w-full rounded-md input-field text-center" title="Archer Health">
                    </div>
                </div>
            </div>
        </form>
    </div>

    <!-- Chart -->
    <div class="card p-4 rounded-lg shadow-lg flex-grow flex flex-col overflow-hidden">
        <div class="flex justify-between items-center mb-3 flex-shrink-0">
            <h2 class="text-xl font-semibold text-white" data-translate-key="chart_title">Alliance Comparison Chart</h2>
            <div class="flex space-x-2">
                <button id="analytics-btn" class="bg-yellow-600 hover:bg-yellow-700 text-white font-bold py-2 px-4 rounded-md btn">
                    <i class="fas fa-trophy mr-2 text-lg"></i><span data-translate-key="analytics">Alliance Analytics</span>
                </button>
                <button id="compare-selected-btn" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-md btn" disabled>
                    <i class="fas fa-chart-bar mr-2 text-lg"></i><span data-translate-key="compare_selected">Compare Selected</span> (<span id="compare-count">0</span>)
                </button>
            </div>
        </div>
        <div class="overflow-y-auto flex-grow">
            <table class="w-full text-left text-sm">
                <thead class="table-header text-xs text-gray-300 uppercase">
                    <tr>
                        <th class="w-12 text-center" title="Compare Players"><i class="fas fa-search text-2xl"></i></th>
                        <th class="w-12 text-center" onclick="sortStats('rank')">#</th>
                        <th onclick="sortStats('playerName')" data-translate-key="th_player">Player</th>
                        <th class="bg-blue-900/50" onclick="sortStats('infAttack')" data-translate-key="th_inf_att">Inf Att</th>
                        <th class="bg-blue-900/50" onclick="sortStats('infDefense')" data-translate-key="th_inf_def">Inf Def</th>
                        <th class="bg-blue-900/50" onclick="sortStats('infLethality')" data-translate-key="th_inf_let">Inf Let</th>
                        <th class="bg-blue-900/50" onclick="sortStats('infHp')" data-translate-key="th_inf_hp">Inf HP</th>
                        <th class="bg-green-900/50" onclick="sortStats('cavAttack')" data-translate-key="th_cav_att">Cav Att</th>
                        <th class="bg-green-900/50" onclick="sortStats('cavDefense')" data-translate-key="th_cav_def">Cav Def</th>
                        <th class="bg-green-900/50" onclick="sortStats('cavLethality')" data-translate-key="th_cav_let">Cav Let</th>
                        <th class="bg-green-900/50" onclick="sortStats('cavHp')" data-translate-key="th_cav_hp">Cav HP</th>
                        <th class="bg-red-900/50" onclick="sortStats('arcAttack')" data-translate-key="th_arc_att">Arc Att</th>
                        <th class="bg-red-900/50" onclick="sortStats('arcDefense')" data-translate-key="th_arc_def">Arc Def</th>
                        <th class="bg-red-900/50" onclick="sortStats('arcLethality')" data-translate-key="th_arc_let">Arc Let</th>
                        <th class="bg-red-900/50" onclick="sortStats('arcHp')" data-translate-key="th_arc_hp">Arc HP</th>
                        <th onclick="sortStats('trueScore')" data-translate-key="th_true_score">True Score â–¼</th>
                        <th onclick="sortStats('realScore')" data-translate-key="th_real_score">Real Score</th>
                        <th onclick="sortStats('date')" data-translate-key="th_last_update">Last Update</th>
                        <th data-translate-key="th_actions">Actions</th>
                    </tr>
                </thead>
                <tbody id="stats-table-body">
                    <!-- Rows will be injected by JavaScript -->
                </tbody>
            </table>
        </div>
    </div>
    
    <footer class="flex justify-between items-center text-xs text-gray-500 flex-shrink-0">
        <p id="db-status" class="text-sm" data-translate-key="db_connecting">Connecting to database...</p>
        <button id="changelog-btn" class="hover:text-gray-400" data-translate-key="changelog">Change Log</button>
    </footer>

    <!-- Modals (Confirmation modal is now last to ensure it's on top) -->
    <div id="help-modal" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-70 hidden z-50">
        <div class="bg-gray-800 rounded-lg shadow-xl p-6 w-full max-w-3xl border border-gray-700">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-bold text-white" data-translate-key="help_title">How to Use This Dashboard</h3>
                <button id="help-modal-close-btn" class="text-gray-400 hover:text-white">&times;</button>
            </div>
            <ul class="list-disc list-inside space-y-3 text-gray-300" data-translate-key="help_list">
                <!-- Content will be translated -->
            </ul>
        </div>
    </div>
    
    <div id="changelog-modal" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-70 hidden z-50">
        <div class="bg-gray-800 rounded-lg shadow-xl p-6 w-full max-w-2xl border border-gray-700 h-3/4 flex flex-col">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-bold text-white" data-translate-key="changelog">Change Log</h3>
                <button id="changelog-modal-close-btn" class="text-gray-400 hover:text-white">&times;</button>
            </div>
            <div class="overflow-y-auto space-y-4 text-gray-300">
                 <div>
                    <h4 class="font-bold text-yellow-400">Version 2.2 (Current)</h4>
                    <ul class="list-disc list-inside text-sm mt-1">
                        <li>Added Help/Features modal.</li>
                        <li>Relaxed specialization criteria to 10% for broader classification.</li>
                        <li>Expanded Top Players by Unit to Top 5 in analytics.</li>
                        <li>Removed "True Score Formula" from instructions for a cleaner UI.</li>
                    </ul>
                </div>
                 <div>
                    <h4 class="font-bold text-yellow-400">Version 2.1</h4>
                    <ul class="list-disc list-inside text-sm mt-1">
                        <li>Redesigned header and footer for cleaner layout.</li>
                        <li>Replaced language dropdown with a visual flag banner.</li>
                        <li>Added Change Log modal.</li>
                        <li>Added Korean, French, and Persian translations.</li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-bold text-yellow-400">Version 2.0</h4>
                    <ul class="list-disc list-inside text-sm mt-1">
                         <li>Added comprehensive Alliance Analytics dashboard.</li>
                        <li>Added Troop Specialization identifiers.</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>


    <div id="history-modal" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-70 hidden z-50">
        <div class="bg-gray-800 rounded-lg shadow-xl p-6 w-full max-w-4xl border border-gray-700 flex flex-col h-3/4">
            <div class="flex justify-between items-center mb-4">
                <h3 id="history-modal-title" class="text-lg font-bold text-white">Update History</h3>
                <button id="history-modal-close-btn" class="text-gray-400 hover:text-white">&times;</button>
            </div>
            <div id="history-modal-body" class="overflow-y-auto space-y-2 flex-grow">
                <!-- History entries will be injected here -->
            </div>
            <div class="mt-6 pt-4 border-t border-gray-700 flex-shrink-0">
                <div class="flex justify-between items-center mb-2">
                    <h4 class="text-md font-semibold" data-translate-key="history_graph_title">Real Score Over Time</h4>
                    <select id="history-time-filter" class="input-field rounded-md text-sm">
                        <option value="all" data-translate-key="all_time">All Time</option>
                        <option value="1m" data-translate-key="last_month">Last Month</option>
                        <option value="3m" data-translate-key="last_3_months">Last 3 Months</option>
                        <option value="6m" data-translate-key="last_6_months">Last 6 Months</option>
                        <option value="1y" data-translate-key="last_year">Last Year</option>
                    </select>
                </div>
                <div class="relative h-64">
                    <canvas id="history-chart-canvas"></canvas>
                </div>
            </div>
        </div>
    </div>

    <div id="chart-modal" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-70 hidden z-50">
        <div class="bg-gray-800 rounded-lg shadow-xl p-6 w-full max-w-6xl border border-gray-700 flex flex-col h-5/6">
            <div class="flex justify-between items-center mb-4">
                <h3 id="chart-modal-title" class="text-lg font-bold text-white">Stat Comparison</h3>
                <button id="chart-modal-close-btn" class="text-gray-400 hover:text-white">&times;</button>
            </div>
            <div class="flex-grow relative">
                <canvas id="comparison-chart-canvas"></canvas>
            </div>
        </div>
    </div>
    
    <div id="analytics-modal" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-70 hidden z-50">
        <div class="bg-gray-800 rounded-lg shadow-xl p-6 w-full max-w-6xl border border-gray-700 flex flex-col h-[90%]">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-bold text-white" data-translate-key="analytics">Alliance Analytics</h3>
                <button id="analytics-modal-close-btn" class="text-gray-400 hover:text-white">&times;</button>
            </div>
            <div id="analytics-modal-body" class="overflow-y-auto space-y-6">
                <!-- Analytics content will be injected here -->
            </div>
        </div>
    </div>

    <div id="custom-modal" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-70 hidden z-50">
        <div class="bg-gray-800 rounded-lg shadow-xl p-6 w-full max-w-md border border-gray-700">
            <h3 id="modal-title" class="text-lg font-bold text-white mb-4">Confirm Action</h3>
            <p id="modal-message" class="text-gray-300 mb-6">Are you sure?</p>
            <div class="flex justify-end space-x-4">
                <button id="modal-cancel-btn" class="px-4 py-2 bg-gray-600 hover:bg-gray-700 rounded-md text-white font-semibold btn" data-translate-key="cancel">Cancel</button>
                <button id="modal-confirm-btn" class="px-4 py-2 bg-red-600 hover:bg-red-700 rounded-md text-white font-semibold btn" data-translate-key="confirm">Confirm</button>
            </div>
        </div>
    </div>


    <script type="module">
        import { initializeApp, getApps } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
        import { getFirestore, collection, doc, onSnapshot, addDoc, setDoc, deleteDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

        // --- ğŸ”‘ PRODUCTION CONFIGURATION ğŸ”‘ ---
        // IMPORTANT SECURITY NOTE: These keys are meant to be public for web clients. 
        // Firebase security is handled by your project's Security Rules and the authorized
        // domains you set in the Firebase console, not by hiding these keys.
        // The "Public leak" warning from GitHub is a general check and can be acknowledged
        // as long as your Firestore rules are secure (e.g., allow read/write: if request.auth != null;).
        const USER_FIREBASE_CONFIG = {
            apiKey: "AIzaSyCmFXqV1rp1G3xbfCE368R9rw5G7ZPjPeQ",
            authDomain: "alliance-stats-96973.firebaseapp.com",
            projectId: "alliance-stats-96973",
            storageBucket: "alliance-stats-96973.appspot.com",
            messagingSenderId: "866174182881",
            appId: "1:866174182881:web:aef54fc8da562d8b_541ea0"
        };
        
        // --- TRANSLATION ---
        const translations = {
            en: {
                main_title: "Alliance Stat Comparison", db_connecting: "Connecting to database...", db_connected: "âœ… Connected", instructions_title: "Instructions & Info", rule1: "Rule 1: NO BUFFS active.", rule2: "Rule 2: Test rally an alt with NO troops.", rule3: "Rule 3: Use 4 Chenkos w/ lvl 5 Stand of Arms.", rule4: "Rule 4: Update at least once a week.", entry_title: "Manual Data Entry", entry_tip: "Tip: Use 'Tab' or 'Enter' to move through inputs in order.", player_name: "Player Name", player_name_placeholder: "Enter player name", save_stats: "Save Stats", cancel: "Cancel", infantry: "Infantry", cavalry: "Cavalry", archer: "Archer", chart_title: "Alliance Comparison Chart", analytics: "Alliance Analytics", compare_selected: "Compare Selected", th_player: "Player", th_inf_att: "Inf Att", th_inf_def: "Inf Def", th_inf_let: "Inf Let", th_inf_hp: "Inf HP", th_cav_att: "Cav Att", th_cav_def: "Cav Def", th_cav_let: "Cav Let", th_cav_hp: "Cav HP", th_arc_att: "Arc Att", th_arc_def: "Arc Def", th_arc_let: "Arc Let", th_arc_hp: "Arc HP", th_true_score: "True Score", th_real_score: "Real Score", th_last_update: "Last Update", th_actions: "Actions", confirm: "Confirm", history_graph_title: "Real Score Over Time", all_time: "All Time", last_month: "Last Month", last_3_months: "Last 3 Months", last_6_months: "Last 6 Months", last_year: "Last Year", update_stats: "Update Stats", confirm_deletion_title: "Confirm Deletion", confirm_deletion_msg: "This will delete ALL entries for {playerName}. This action cannot be undone. Are you sure?", confirm_revert_title: "Confirm Revert", confirm_revert_msg: "This will copy the stats from this historical entry and save it as the new latest entry for {playerName}. This is non-destructive. Are you sure?", revert: "Revert", history_for: "Update History for {playerName}", real_score_label: "Real Score:", top_10_rally: "Top 10 Rally Leaders (by True Score)", most_improved: "Most Improved Players (by Real Score)", no_history: "Not enough historical data yet.", alliance_comp: "Alliance Composition", top_5_inf: "Top 5 Infantry Players", top_5_cav: "Top 5 Cavalry Players", top_5_arc: "Top 5 Archer Players", last_5_entries: "Last 5 New Entries", submitted_on: "submitted on", no_entries_yet: "No entries yet.", features: "Features", changelog: "Change Log", help_title: "How to Use This Dashboard", help_list: `<li><strong>Weighted Ranking:</strong> The 'True Score' ranks players based on a formula that values Lethality (x1.2) and Health (x1.1) more than Attack/Defense.</li><li><strong>Track Progress:</strong> After an update, small <span class="text-green-400">(+green)</span> or <span class="text-red-400">(-red)</span> numbers show the change in each stat.</li><li><strong>View History:</strong> Click the <i class="fas fa-history text-indigo-400"></i> icon on any row to see a player's full update history, including a growth chart. You can also click the small growth numbers.</li><li><strong>Revert Mistakes:</strong> Inside the history log, click the 'Revert' button on an old entry to restore those stats.</li><li><strong>Quick Compare:</strong> Double-click anywhere on a player's row to open a chart comparing their stats to the alliance average.</li><li><strong>Multi-Compare:</strong> Use the checkboxes on the left to select up to 5 players, then click the 'Compare Selected' button to see them all on one chart.</li><li><strong>Analyze the Alliance:</strong> Click the 'Alliance Analytics' button for a high-level overview, including top players and strategic composition.</li>`
            },
            es: {
                main_title: "ComparaciÃ³n de EstadÃ­sticas de Alianza", db_connecting: "Conectando a la base de datos...", db_connected: "âœ… Conectado", instructions_title: "Instrucciones e InformaciÃ³n", rule1: "Regla 1: SIN BUFFS activos.", rule2: "Regla 2: Atacar una cuenta alternativa SIN tropas.", rule3: "Regla 3: Usar 4 Chenkos con Habilidad de armas nivel 5.", rule4: "Regla 4: Actualizar al menos una vez por semana.", entry_title: "Entrada Manual de Datos", entry_tip: "Consejo: Usa 'Tab' o 'Enter' para moverte por las entradas.", player_name: "Nombre del Jugador", player_name_placeholder: "Introduce el nombre del jugador", save_stats: "Guardar EstadÃ­sticas", cancel: "Cancelar", infantry: "InfanterÃ­a", cavalry: "CaballerÃ­a", archer: "Arquero", chart_title: "Tabla de ComparaciÃ³n de Alianza", analytics: "AnÃ¡lisis de Alianza", compare_selected: "Comparar Seleccionados", th_player: "Jugador", th_inf_att: "Ata Inf", th_inf_def: "Def Inf", th_inf_let: "Let Inf", th_inf_hp: "Sal Inf", th_cav_att: "Ata Cab", th_cav_def: "Def Cab", th_cav_let: "Let Cab", th_cav_hp: "Sal Cab", th_arc_att: "Ata Arq", th_arc_def: "Def Arq", th_arc_let: "Let Arq", th_arc_hp: "Sal Arq", th_true_score: "PuntuaciÃ³n Verdadera", th_real_score: "PuntuaciÃ³n Real", th_last_update: "Ãšltima ActualizaciÃ³n", th_actions: "Acciones", confirm: "Confirmar", history_graph_title: "PuntuaciÃ³n Real a lo Largo del Tiempo", all_time: "Todo el Tiempo", last_month: "Ãšltimo Mes", last_3_months: "Ãšltimos 3 Meses", last_6_months: "Ãšltimos 6 Meses", last_year: "Ãšltimo AÃ±o", update_stats: "Actualizar EstadÃ­sticas", confirm_deletion_title: "Confirmar EliminaciÃ³n", confirm_deletion_msg: "Esto eliminarÃ¡ TODAS las entradas para {playerName}. Esta acciÃ³n no se puede deshacer. Â¿EstÃ¡s seguro?", confirm_revert_title: "Confirmar ReversiÃ³n", confirm_revert_msg: "Esto copiarÃ¡ las estadÃ­sticas de esta entrada histÃ³rica y la guardarÃ¡ como la nueva entrada mÃ¡s reciente para {playerName}. Esto no es destructivo. Â¿EstÃ¡s seguro?", revert: "Revertir", history_for: "Historial de Actualizaciones de {playerName}", real_score_label: "PuntuaciÃ³n Real:", top_10_rally: "Top 10 LÃ­deres de Rally (por PuntuaciÃ³n Verdadera)", most_improved: "Jugadores con Mayor Progreso (por PuntuaciÃ³n Real)", no_history: "AÃºn no hay suficientes datos histÃ³ricos.", alliance_comp: "ComposiciÃ³n de la Alianza", top_5_inf: "Top 5 Jugadores de InfanterÃ­a", top_5_cav: "Top 5 Jugadores de CaballerÃ­a", top_5_arc: "Top 5 Jugadores de Arquero", last_5_entries: "Ãšltimas 5 Entradas Nuevas", submitted_on: "enviado el", no_entries_yet: "AÃºn no hay entradas.", features: "CaracterÃ­sticas", changelog: "Registro de Cambios", help_title: "CÃ³mo Usar Este Panel", help_list: `<li><strong>ClasificaciÃ³n Ponderada:</strong> La 'PuntuaciÃ³n Verdadera' clasifica a los jugadores segÃºn una fÃ³rmula que valora mÃ¡s la Letalidad (x1.2) y la Salud (x1.1) que el Ataque/Defensa.</li><li><strong>Seguir el Progreso:</strong> DespuÃ©s de una actualizaciÃ³n, pequeÃ±os nÃºmeros <span class="text-green-400">(+verdes)</span> o <span class="text-red-400">(-rojos)</span> muestran el cambio en cada estadÃ­stica.</li><li><strong>Ver Historial:</strong> Haz clic en el Ã­cono <i class="fas fa-history text-indigo-400"></i> en cualquier fila para ver el historial completo de actualizaciones de un jugador, incluyendo un grÃ¡fico de crecimiento. TambiÃ©n puedes hacer clic en los pequeÃ±os nÃºmeros de crecimiento.</li><li><strong>Revertir Errores:</strong> Dentro del historial, haz clic en el botÃ³n 'Revertir' en una entrada antigua para restaurar esas estadÃ­sticas.</li><li><strong>ComparaciÃ³n RÃ¡pida:</strong> Haz doble clic en cualquier parte de la fila de un jugador para abrir un grÃ¡fico que compara sus estadÃ­sticas con el promedio de la alianza.</li><li><strong>Multi-ComparaciÃ³n:</strong> Usa las casillas de verificaciÃ³n a la izquierda para seleccionar hasta 5 jugadores, luego haz clic en el botÃ³n 'Comparar Seleccionados' para verlos todos en un grÃ¡fico.</li><li><strong>Analizar la Alianza:</strong> Haz clic en el botÃ³n 'AnÃ¡lisis de Alianza' para una vista general, incluyendo los mejores jugadores y la composiciÃ³n estratÃ©gica.</li>`
            },
            zh: {
                main_title: "è”ç›Ÿç»Ÿè®¡æ¯”è¾ƒ", db_connecting: "æ­£åœ¨è¿æ¥æ•°æ®åº“...", db_connected: "âœ… å·²è¿æ¥", instructions_title: "è¯´æ˜ä¸ä¿¡æ¯", rule1: "è§„åˆ™1ï¼šæ— å¢ç›ŠçŠ¶æ€", rule2: "è§„åˆ™2ï¼šæ”»å‡»æ— éƒ¨é˜Ÿå°å·", rule3: "è§„åˆ™3ï¼šä½¿ç”¨4ä¸ª5çº§æŠ€èƒ½çš„é™ˆç§‘", rule4: "è§„åˆ™4ï¼šæ¯å‘¨è‡³å°‘æ›´æ–°ä¸€æ¬¡", entry_title: "æ‰‹åŠ¨æ•°æ®è¾“å…¥", entry_tip: "æç¤ºï¼šä½¿ç”¨'Tab'æˆ–'Enter'é”®æŒ‰é¡ºåºç§»åŠ¨", player_name: "ç©å®¶åç§°", player_name_placeholder: "è¾“å…¥ç©å®¶åç§°", save_stats: "ä¿å­˜ç»Ÿè®¡", cancel: "å–æ¶ˆ", infantry: "æ­¥å…µ", cavalry: "éª‘å…µ", archer: "å¼“å…µ", chart_title: "è”ç›Ÿæ¯”è¾ƒå›¾è¡¨", analytics: "è”ç›Ÿåˆ†æ", compare_selected: "æ¯”è¾ƒå·²é€‰", th_player: "ç©å®¶", th_inf_att: "æ­¥å…µæ”»å‡»", th_inf_def: "æ­¥å…µé˜²å¾¡", th_inf_let: "æ­¥å…µæ€ä¼¤", th_inf_hp: "æ­¥å…µç”Ÿå‘½", th_cav_att: "éª‘å…µæ”»å‡»", th_cav_def: "éª‘å…µé˜²å¾¡", th_cav_let: "éª‘å…µæ€ä¼¤", th_cav_hp: "éª‘å…µç”Ÿå‘½", th_arc_att: "å¼“å…µæ”»å‡»", th_arc_def: "å¼“å…µé˜²å¾¡", th_arc_let: "å¼“å…µæ€ä¼¤", th_arc_hp: "å¼“å…µç”Ÿå‘½", th_true_score: "çœŸå®è¯„åˆ†", th_real_score: "åŸå§‹è¯„åˆ†", th_last_update: "æœ€åæ›´æ–°", th_actions: "æ“ä½œ", confirm: "ç¡®è®¤", history_graph_title: "åŸå§‹è¯„åˆ†å†å²", all_time: "æ‰€æœ‰æ—¶é—´", last_month: "ä¸Šä¸ªæœˆ", last_3_months: "è¿‡å»3ä¸ªæœˆ", last_6_months: "è¿‡å»6ä¸ªæœˆ", last_year: "å»å¹´", update_stats: "æ›´æ–°ç»Ÿè®¡", confirm_deletion_title: "ç¡®è®¤åˆ é™¤", confirm_deletion_msg: "è¿™å°†åˆ é™¤{playerName}çš„æ‰€æœ‰æ¡ç›®ã€‚æ­¤æ“ä½œæ— æ³•æ’¤é”€ã€‚ç¡®å®šå—ï¼Ÿ", confirm_revert_title: "ç¡®è®¤æ¢å¤", confirm_revert_msg: "è¿™å°†å¤åˆ¶æ­¤å†å²æ¡ç›®çš„ç»Ÿè®¡æ•°æ®å¹¶å°†å…¶ä¿å­˜ä¸º{playerName}çš„æœ€æ–°æ¡ç›®ã€‚æ­¤æ“ä½œæ˜¯æ— æŸçš„ã€‚ç¡®å®šå—ï¼Ÿ", revert: "æ¢å¤", history_for: "{playerName}çš„æ›´æ–°å†å²", real_score_label: "åŸå§‹è¯„åˆ†:", top_10_rally: "é›†ç»“é˜Ÿé•¿å‰10åï¼ˆæŒ‰çœŸå®è¯„åˆ†ï¼‰", most_improved: "è¿›æ­¥æœ€å¿«ç©å®¶ï¼ˆæŒ‰åŸå§‹è¯„åˆ†ï¼‰", no_history: "å°šæ— è¶³å¤Ÿå†å²æ•°æ®", alliance_comp: "è”ç›Ÿæ„æˆ", top_5_inf: "æ­¥å…µç©å®¶å‰5å", top_5_cav: "éª‘å…µç©å®¶å‰5å", top_5_arc: "å¼“å…µç©å®¶å‰5å", last_5_entries: "æœ€è¿‘5æ¡æ–°æ¡ç›®", submitted_on: "æäº¤äº", no_entries_yet: "æš‚æ— æ¡ç›®", features: "åŠŸèƒ½", changelog: "æ›´æ–°æ—¥å¿—", help_title: "å¦‚ä½•ä½¿ç”¨æ­¤ä»ªè¡¨æ¿", help_list: `<li><strong>åŠ æƒæ’å:</strong> â€œçœŸå®è¯„åˆ†â€æ ¹æ®ä¸€ä¸ªæ›´çœ‹é‡æ€ä¼¤åŠ›(x1.2)å’Œç”Ÿå‘½å€¼(x1.1)çš„å…¬å¼å¯¹ç©å®¶è¿›è¡Œæ’åã€‚</li><li><strong>è·Ÿè¸ªè¿›åº¦:</strong> æ›´æ–°åï¼Œå°çš„<span class="text-green-400">(+ç»¿è‰²)</span>æˆ–<span class="text-red-400">(-çº¢è‰²)</span>æ•°å­—æ˜¾ç¤ºæ¯ä¸ªç»Ÿè®¡æ•°æ®çš„å˜åŒ–ã€‚</li><li><strong>æŸ¥çœ‹å†å²:</strong> ç‚¹å‡»ä»»ä½•è¡Œä¸Šçš„<i class="fas fa-history text-indigo-400"></i>å›¾æ ‡ï¼ŒæŸ¥çœ‹ç©å®¶çš„å®Œæ•´æ›´æ–°å†å²ï¼ŒåŒ…æ‹¬å¢é•¿å›¾è¡¨ã€‚æ‚¨ä¹Ÿå¯ä»¥ç‚¹å‡»å°çš„å¢é•¿æ•°å­—ã€‚</li><li><strong>æ’¤é”€é”™è¯¯:</strong> åœ¨å†å²è®°å½•ä¸­ï¼Œç‚¹å‡»æ—§æ¡ç›®ä¸Šçš„â€œæ¢å¤â€æŒ‰é’®ä»¥æ¢å¤é‚£äº›ç»Ÿè®¡æ•°æ®ã€‚</li><li><strong>å¿«é€Ÿæ¯”è¾ƒ:</strong> åŒå‡»ç©å®¶è¡Œä¸Šçš„ä»»ä½•ä½ç½®ï¼Œæ‰“å¼€ä¸€ä¸ªå›¾è¡¨ï¼Œå°†å…¶ç»Ÿè®¡æ•°æ®ä¸è”ç›Ÿå¹³å‡å€¼è¿›è¡Œæ¯”è¾ƒã€‚</li><li><strong>å¤šé‡æ¯”è¾ƒ:</strong> ä½¿ç”¨å·¦ä¾§çš„å¤é€‰æ¡†é€‰æ‹©æœ€å¤š5åç©å®¶ï¼Œç„¶åç‚¹å‡»â€œæ¯”è¾ƒå·²é€‰â€æŒ‰é’®ï¼Œå°†ä»–ä»¬å…¨éƒ¨æ˜¾ç¤ºåœ¨ä¸€ä¸ªå›¾è¡¨ä¸Šã€‚</li><li><strong>åˆ†æè”ç›Ÿ:</strong> ç‚¹å‡»â€œè”ç›Ÿåˆ†æâ€æŒ‰é’®ï¼ŒæŸ¥çœ‹åŒ…æ‹¬é¡¶å°–ç©å®¶å’Œæˆ˜ç•¥æ„æˆåœ¨å†…çš„é«˜çº§æ¦‚è§ˆã€‚</li>`
            },
            tl: {
                main_title: "Paghahambing ng Istatistika ng Alyansa", db_connecting: "Kumokonekta sa database...", db_connected: "âœ… Nakakonekta", instructions_title: "Mga Panuto at Impormasyon", rule1: "Rule 1: WALANG BUFFS.", rule2: "Rule 2: Subukang mag-rally sa alt account na WALANG tropa.", rule3: "Rule 3: Gumamit ng 4 na Chenkos na may lvl 5 Stand of Arms.", rule4: "Rule 4: Mag-update kahit isang beses sa isang linggo.", entry_title: "Manu-manong Pagpasok ng Datos", entry_tip: "Tip: Gamitin ang 'Tab' o 'Enter' para lumipat sa mga input.", player_name: "Pangalan ng Manlalaro", player_name_placeholder: "Ilagay ang pangalan ng manlalaro", save_stats: "I-save ang Stats", cancel: "Kanselahin", infantry: "Infantry", cavalry: "Cavalry", archer: "Archer", chart_title: "Tsart ng Paghahambing ng Alyansa", analytics: "Analytics ng Alyansa", compare_selected: "Ikumpara ang mga Pinili", th_player: "Manlalaro", th_inf_att: "Atake Inf", th_inf_def: "Depensa Inf", th_inf_let: "Let Inf", th_inf_hp: "HP Inf", th_cav_att: "Atake Cav", th_cav_def: "Depensa Cav", th_cav_let: "Let Cav", th_cav_hp: "HP Cav", th_arc_att: "Atake Arc", th_arc_def: "Depensa Arc", th_arc_let: "Let Arc", th_arc_hp: "HP Arc", th_true_score: "Tunay na Iskor", th_real_score: "Real na Iskor", th_last_update: "Huling Update", th_actions: "Mga Aksyon", confirm: "Kumpirmahin", history_graph_title: "Real na Iskor sa Paglipas ng Panahon", all_time: "Lahat ng Oras", last_month: "Huling Buwan", last_3_months: "Huling 3 Buwan", last_6_months: "Huling 6 na Buwan", last_year: "Huling Taon", update_stats: "I-update ang Stats", confirm_deletion_title: "Kumpirmahin ang Pagbura", confirm_deletion_msg: "Buburahin nito ang LAHAT ng entry para kay {playerName}. Hindi na ito maibabalik. Sigurado ka ba?", confirm_revert_title: "Kumpirmahin ang Pagbabalik", confirm_revert_msg: "Kokopyahin nito ang stats mula sa historical entry na ito at ise-save bilang pinakabagong entry para kay {playerName}. Ito ay non-destructive. Sigurado ka ba?", revert: "Ibalik", history_for: "Update History para kay {playerName}", real_score_label: "Real na Iskor:", top_10_rally: "Top 10 Rally Leaders (base sa Tunay na Iskor)", most_improved: "Mga Manlalarong may Pinakamalaking Pag-unlad (base sa Real na Iskor)", no_history: "Wala pang sapat na historical data.", alliance_comp: "Komposisyon ng Alyansa", top_5_inf: "Top 5 Manlalaro ng Infantry", top_5_cav: "Top 5 Manlalaro ng Cavalry", top_5_arc: "Top 5 Manlalaro ng Archer", last_5_entries: "Huling 5 Bagong Entry", submitted_on: "isinumite noong", no_entries_yet: "Wala pang mga entry.", features: "Mga Tampok", changelog: "Talaan ng Pagbabago", help_title: "Paano Gamitin ang Dashboard na Ito", help_list: `<li><strong>Pemberat na Ranggo:</strong> Ang 'Tunay na Iskor' ay nagraranggo sa mga manlalaro batay sa isang formula na mas pinapahalagahan ang Lethality (x1.2) at Health (x1.1) kaysa sa Attack/Defense.</li><li><strong>Subaybayan ang Progreso:</strong> Pagkatapos ng isang update, ipinapakita ng maliliit na numerong <span class="text-green-400">(+berde)</span> o <span class="text-red-400">(-pula)</span> ang pagbabago sa bawat stat.</li><li><strong>Tingnan ang Kasaysayan:</strong> I-click ang icon na <i class="fas fa-history text-indigo-400"></i> sa anumang hilera para makita ang buong kasaysayan ng update ng isang manlalaro, kasama ang isang growth chart. Maaari mo ring i-click ang maliliit na numero ng paglago.</li><li><strong>Ibalik ang mga Pagkakamali:</strong> Sa loob ng log ng kasaysayan, i-click ang 'Ibalik' na buton sa isang lumang entry para ibalik ang mga stat na iyon.</li><li><strong>Mabilis na Paghahambing:</strong> I-double-click kahit saan sa hilera ng isang manlalaro para magbukas ng tsart na naghahambing ng kanilang mga stat sa average ng alyansa.</li><li><strong>Maramihang Paghahambing:</strong> Gamitin ang mga checkbox sa kaliwa para pumili ng hanggang 5 manlalaro, pagkatapos ay i-click ang 'Ikumpara ang mga Pinili' na buton para makita silang lahat sa isang tsart.</li><li><strong>Suriin ang Alyansa:</strong> I-click ang 'Analytics ng Alyansa' na buton para sa isang pangkalahatang-ideya, kasama ang mga nangungunang manlalaro at strategic composition.</li>`
            },
            ar: {
                main_title: "Ù…Ù‚Ø§Ø±Ù†Ø© Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØªØ­Ø§Ù„Ù", db_connecting: "Ø¬Ø§Ø±Ù Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...", db_connected: "âœ… Ù…ØªØµÙ„", instructions_title: "ØªØ¹Ù„ÙŠÙ…Ø§Øª ÙˆÙ…Ø¹Ù„ÙˆÙ…Ø§Øª", rule1: "Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø© 1: Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ¹Ø²ÙŠØ²Ø§Øª Ù†Ø´Ø·Ø©.", rule2: "Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø© 2: Ø§Ø®ØªØ¨Ø§Ø± Ù‡Ø¬ÙˆÙ… Ø¹Ù„Ù‰ Ø­Ø³Ø§Ø¨ Ø¨Ø¯ÙŠÙ„ Ø¨Ø¯ÙˆÙ† Ù‚ÙˆØ§Øª.", rule3: "Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø© 3: Ø§Ø³ØªØ®Ø¯Ù… 4 Ø£Ø¨Ø·Ø§Ù„ ØªØ´ÙŠÙ†ÙƒÙˆ Ø¨Ù…Ù‡Ø§Ø±Ø© Ù…Ø³ØªÙˆÙ‰ 5.", rule4: "Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø© 4: Ø§Ù„ØªØ­Ø¯ÙŠØ« Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙŠ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„.", entry_title: "Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙŠØ¯ÙˆÙŠÙ‹Ø§", entry_tip: "Ù†ØµÙŠØ­Ø©: Ø§Ø³ØªØ®Ø¯Ù… 'Tab' Ø£Ùˆ 'Enter' Ù„Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª Ø¨Ø§Ù„ØªØ±ØªÙŠØ¨.", player_name: "Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨", player_name_placeholder: "Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨", save_stats: "Ø­ÙØ¸ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª", cancel: "Ø¥Ù„ØºØ§Ø¡", infantry: "Ø§Ù„Ù…Ø´Ø§Ø©", cavalry: "Ø§Ù„ÙØ±Ø³Ø§Ù†", archer: "Ø§Ù„Ø±Ù…Ø§Ø©", chart_title: "Ù…Ø®Ø·Ø· Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„ØªØ­Ø§Ù„Ù", analytics: "ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„ØªØ­Ø§Ù„Ù", compare_selected: "Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ù…Ø­Ø¯Ø¯", th_player: "Ø§Ù„Ù„Ø§Ø¹Ø¨", th_inf_att: "Ù‡Ø¬ÙˆÙ… Ø§Ù„Ù…Ø´Ø§Ø©", th_inf_def: "Ø¯ÙØ§Ø¹ Ø§Ù„Ù…Ø´Ø§Ø©", th_inf_let: "ÙØªÙƒ Ø§Ù„Ù…Ø´Ø§Ø©", th_inf_hp: "ØµØ­Ø© Ø§Ù„Ù…Ø´Ø§Ø©", th_cav_att: "Ù‡Ø¬ÙˆÙ… Ø§Ù„ÙØ±Ø³Ø§Ù†", th_cav_def: "Ø¯ÙØ§Ø¹ Ø§Ù„ÙØ±Ø³Ø§Ù†", th_cav_let: "ÙØªÙƒ Ø§Ù„ÙØ±Ø³Ø§Ù†", th_cav_hp: "ØµØ­Ø© Ø§Ù„ÙØ±Ø³Ø§Ù†", th_arc_att: "Ù‡Ø¬ÙˆÙ… Ø§Ù„Ø±Ù…Ø§Ø©", th_arc_def: "Ø¯ÙØ§Ø¹ Ø§Ù„Ø±Ù…Ø§Ø©", th_arc_let: "ÙØªÙƒ Ø§Ù„Ø±Ù…Ø§Ø©", th_arc_hp: "ØµØ­Ø© Ø§Ù„Ø±Ù…Ø§Ø©", th_true_score: "Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©", th_real_score: "Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø£ÙˆÙ„ÙŠØ©", th_last_update: "Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«", th_actions: "Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª", confirm: "ØªØ£ÙƒÙŠØ¯", history_graph_title: "Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø£ÙˆÙ„ÙŠØ© Ø¹Ø¨Ø± Ø§Ù„Ø²Ù…Ù†", all_time: "ÙƒÙ„ Ø§Ù„Ø£ÙˆÙ‚Ø§Øª", last_month: "Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ù…Ø§Ø¶ÙŠ", last_3_months: "Ø¢Ø®Ø± 3 Ø£Ø´Ù‡Ø±", last_6_months: "Ø¢Ø®Ø± 6 Ø£Ø´Ù‡Ø±", last_year: "Ø§Ù„Ø¹Ø§Ù… Ø§Ù„Ù…Ø§Ø¶ÙŠ", update_stats: "ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª", confirm_deletion_title: "ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø°Ù", confirm_deletion_msg: "Ø³ÙŠØ¤Ø¯ÙŠ Ù‡Ø°Ø§ Ø¥Ù„Ù‰ Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„Ø§Øª Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù€ {playerName}. Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡. Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ØŸ", confirm_revert_title: "ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø§Ø³ØªØ¹Ø§Ø¯Ø©", confirm_revert_msg: "Ø³ÙŠØ¤Ø¯ÙŠ Ù‡Ø°Ø§ Ø¥Ù„Ù‰ Ù†Ø³Ø® Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù…Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„ØªØ§Ø±ÙŠØ®ÙŠ ÙˆØ­ÙØ¸Ù‡Ø§ ÙƒØ£Ø­Ø¯Ø« Ø¥Ø¯Ø®Ø§Ù„ Ù„Ù€ {playerName}. Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ ØºÙŠØ± Ù…Ø¯Ù…Ø±. Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ØŸ", revert: "Ø§Ø³ØªØ¹Ø§Ø¯Ø©", history_for: "Ø³Ø¬Ù„ Ø§Ù„ØªØ­Ø¯ÙŠØ« Ù„Ù€ {playerName}", real_score_label: "Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø£ÙˆÙ„ÙŠØ©:", top_10_rally: "Ø£ÙØ¶Ù„ 10 Ù‚Ø§Ø¯Ø© Ø­Ø´Ø¯ (Ø­Ø³Ø¨ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©)", most_improved: "Ø§Ù„Ù„Ø§Ø¹Ø¨ÙˆÙ† Ø§Ù„Ø£ÙƒØ«Ø± ØªØ­Ø³Ù†Ù‹Ø§ (Ø­Ø³Ø¨ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø£ÙˆÙ„ÙŠØ©)", no_history: "Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª ØªØ§Ø±ÙŠØ®ÙŠØ© ÙƒØ§ÙÙŠØ© Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†.", alliance_comp: "ØªÙƒÙˆÙŠÙ† Ø§Ù„ØªØ­Ø§Ù„Ù", top_5_inf: "Ø£ÙØ¶Ù„ 5 Ù„Ø§Ø¹Ø¨ÙŠ Ù…Ø´Ø§Ø©", top_5_cav: "Ø£ÙØ¶Ù„ 5 Ù„Ø§Ø¹Ø¨ÙŠ ÙØ±Ø³Ø§Ù†", top_5_arc: "Ø£ÙØ¶Ù„ 5 Ù„Ø§Ø¹Ø¨ÙŠ Ø±Ù…Ø§Ø©", last_5_entries: "Ø¢Ø®Ø± 5 Ø¥Ø¯Ø®Ø§Ù„Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©", submitted_on: "Ø£Ø±Ø³Ù„Øª ÙÙŠ", no_entries_yet: "Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø¯Ø®Ø§Ù„Ø§Øª Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†.", features: "Ø§Ù„Ù…ÙŠØ²Ø§Øª", changelog: "Ø³Ø¬Ù„ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª", help_title: "ÙƒÙŠÙÙŠØ© Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ù‡Ø°Ù‡", help_list: `<li><strong>Ø§Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„Ù…Ø±Ø¬Ø­:</strong> ÙŠØµÙ†Ù 'Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©' Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ ØµÙŠØºØ© ØªØ¹Ø·ÙŠ Ù‚ÙŠÙ…Ø© Ø£ÙƒØ¨Ø± Ù„Ù„ÙØªÙƒ (Ã—1.2) ÙˆØ§Ù„ØµØ­Ø© (Ã—1.1) Ù…Ù‚Ø§Ø±Ù†Ø© Ø¨Ø§Ù„Ù‡Ø¬ÙˆÙ…/Ø§Ù„Ø¯ÙØ§Ø¹.</li><li><strong>ØªØªØ¨Ø¹ Ø§Ù„ØªÙ‚Ø¯Ù…:</strong> Ø¨Ø¹Ø¯ Ø§Ù„ØªØ­Ø¯ÙŠØ«ØŒ ØªØ¸Ù‡Ø± Ø£Ø±Ù‚Ø§Ù… ØµØºÙŠØ±Ø© <span class="text-green-400">(+Ø®Ø¶Ø±Ø§Ø¡)</span> Ø£Ùˆ <span class="text-red-400">(-Ø­Ù…Ø±Ø§Ø¡)</span> Ø§Ù„ØªØºÙŠÙŠØ± ÙÙŠ ÙƒÙ„ Ø¥Ø­ØµØ§Ø¦ÙŠØ©.</li><li><strong>Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¬Ù„:</strong> Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø£ÙŠÙ‚ÙˆÙ†Ø© <i class="fas fa-history text-indigo-400"></i> ÙÙŠ Ø£ÙŠ ØµÙ Ù„Ø¹Ø±Ø¶ Ø³Ø¬Ù„ Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„ÙƒØ§Ù…Ù„ Ù„Ù„Ø§Ø¹Ø¨ØŒ Ø¨Ù…Ø§ ÙÙŠ Ø°Ù„Ùƒ Ù…Ø®Ø·Ø· Ø§Ù„Ù†Ù…Ùˆ. ÙŠÙ…ÙƒÙ†Ùƒ Ø£ÙŠØ¶Ù‹Ø§ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù†Ù…Ùˆ Ø§Ù„ØµØºÙŠØ±Ø©.</li><li><strong>Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ø§Ù„Ø£Ø®Ø·Ø§Ø¡:</strong> Ø¯Ø§Ø®Ù„ Ø³Ø¬Ù„ Ø§Ù„ØªØ§Ø±ÙŠØ®ØŒ Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± 'Ø§Ù„ØªØ±Ø§Ø¬Ø¹' ÙÙŠ Ø¥Ø¯Ø®Ø§Ù„ Ù‚Ø¯ÙŠÙ… Ù„Ø§Ø³ØªØ¹Ø§Ø¯Ø© ØªÙ„Ùƒ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª.</li><li><strong>Ù…Ù‚Ø§Ø±Ù†Ø© Ø³Ø±ÙŠØ¹Ø©:</strong> Ø§Ù†Ù‚Ø± Ù†Ù‚Ø±Ù‹Ø§ Ù…Ø²Ø¯ÙˆØ¬Ù‹Ø§ ÙÙŠ Ø£ÙŠ Ù…ÙƒØ§Ù† Ø¹Ù„Ù‰ ØµÙ Ø§Ù„Ù„Ø§Ø¹Ø¨ Ù„ÙØªØ­ Ù…Ø®Ø·Ø· ÙŠÙ‚Ø§Ø±Ù† Ø¥Ø­ØµØ§Ø¦ÙŠØ§ØªÙ‡ Ø¨Ù…ØªÙˆØ³Ø· Ø§Ù„ØªØ­Ø§Ù„Ù.</li><li><strong>Ù…Ù‚Ø§Ø±Ù†Ø© Ù…ØªØ¹Ø¯Ø¯Ø©:</strong> Ø§Ø³ØªØ®Ø¯Ù… Ù…Ø±Ø¨Ø¹Ø§Øª Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± Ø¹Ù„Ù‰ Ø§Ù„ÙŠØ³Ø§Ø± Ù„ØªØ­Ø¯ÙŠØ¯ Ù…Ø§ ÙŠØµÙ„ Ø¥Ù„Ù‰ 5 Ù„Ø§Ø¹Ø¨ÙŠÙ†ØŒ Ø«Ù… Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± 'Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ù…Ø­Ø¯Ø¯' Ù„Ø±Ø¤ÙŠØªÙ‡Ù… Ø¬Ù…ÙŠØ¹Ù‹Ø§ ÙÙŠ Ù…Ø®Ø·Ø· ÙˆØ§Ø­Ø¯.</li><li><strong>ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØªØ­Ø§Ù„Ù:</strong> Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± 'ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„ØªØ­Ø§Ù„Ù' Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø© Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ù…Ø³ØªÙˆÙ‰ØŒ Ø¨Ù…Ø§ ÙÙŠ Ø°Ù„Ùƒ Ø£ÙØ¶Ù„ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† ÙˆØ§Ù„ØªÙƒÙˆÙŠÙ† Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠ.</li>`
            },
            pt: {
                main_title: "ComparaÃ§Ã£o de EstatÃ­sticas da AlianÃ§a", db_connecting: "Conectando ao banco de dados...", db_connected: "âœ… Conectado", instructions_title: "InstruÃ§Ãµes e InformaÃ§Ãµes", rule1: "Regra 1: SEM BUFFS ativos.", rule2: "Regra 2: Testar um ataque a uma conta alternativa SEM tropas.", rule3: "Regra 3: Usar 4 Chenkos com habilidade Stand of Arms nÃ­vel 5.", rule4: "Regra 4: Atualizar pelo menos uma vez por semana.", entry_title: "Entrada Manual de Dados", entry_tip: "Dica: Use 'Tab' ou 'Enter' para navegar pelas entradas em ordem.", player_name: "Nome do Jogador", player_name_placeholder: "Digite o nome do jogador", save_stats: "Salvar EstatÃ­sticas", cancel: "Cancelar", infantry: "Infantaria", cavalry: "Cavalaria", archer: "Arqueiro", chart_title: "GrÃ¡fico de ComparaÃ§Ã£o da AlianÃ§a", analytics: "AnÃ¡lises da AlianÃ§a", compare_selected: "Comparar Selecionados", th_player: "Jogador", th_inf_att: "Ata Inf", th_inf_def: "Def Inf", th_inf_let: "Let Inf", th_inf_hp: "Vida Inf", th_cav_att: "Ata Cav", th_cav_def: "Def Cav", th_cav_let: "Let Cav", th_cav_hp: "Vida Cav", th_arc_att: "Ata Arq", th_arc_def: "Def Arq", th_arc_let: "Let Arq", th_arc_hp: "Vida Arq", th_true_score: "PontuaÃ§Ã£o Real", th_real_score: "PontuaÃ§Ã£o Bruta", th_last_update: "Ãšltima AtualizaÃ§Ã£o", th_actions: "AÃ§Ãµes", confirm: "Confirmar", history_graph_title: "PontuaÃ§Ã£o Bruta ao Longo do Tempo", all_time: "Todo o PerÃ­odo", last_month: "Ãšltimo MÃªs", last_3_months: "Ãšltimos 3 Meses", last_6_months: "Ãšltimos 6 Meses", last_year: "Ãšltimo Ano", update_stats: "Atualizar EstatÃ­sticas", confirm_deletion_title: "Confirmar ExclusÃ£o", confirm_deletion_msg: "Isso excluirÃ¡ TODAS as entradas de {playerName}. Esta aÃ§Ã£o nÃ£o pode ser desfeita. Tem certeza?", confirm_revert_title: "Confirmar ReversÃ£o", confirm_revert_msg: "Isso copiarÃ¡ as estatÃ­sticas desta entrada histÃ³rica e a salvarÃ¡ como a nova entrada mais recente para {playerName}. Esta aÃ§Ã£o nÃ£o Ã© destrutiva. Tem certeza?", revert: "Reverter", history_for: "HistÃ³rico de AtualizaÃ§Ãµes de {playerName}", real_score_label: "PontuaÃ§Ã£o Bruta:", top_10_rally: "Top 10 LÃ­deres de Ataque (por PontuaÃ§Ã£o Real)", most_improved: "Jogadores que Mais Melhoraram (por PontuaÃ§Ã£o Bruta)", no_history: "Ainda nÃ£o hÃ¡ dados histÃ³ricos suficientes.", alliance_comp: "ComposiÃ§Ã£o da AlianÃ§a", top_5_inf: "Top 5 Jogadores de Infantaria", top_5_cav: "Top 5 Jogadores de Cavalaria", top_5_arc: "Top 5 Jogadores de Arqueiro", last_5_entries: "Ãšltimas 5 Novas Entradas", submitted_on: "enviado em", no_entries_yet: "Nenhuma entrada ainda.", features: "Recursos", changelog: "Registro de AlteraÃ§Ãµes", help_title: "Como Usar este Painel", help_list: `<li><strong>Ranking Ponderado:</strong> O 'PontuaÃ§Ã£o Real' classifica os jogadores com base em uma fÃ³rmula que valoriza mais a Letalidade (x1.2) e a Vida (x1.1) do que o Ataque/Defesa.</li><li><strong>Acompanhar Progresso:</strong> ApÃ³s uma atualizaÃ§Ã£o, pequenos nÃºmeros <span class="text-green-400">(+verdes)</span> ou <span class="text-red-400">(-vermelhos)</span> mostram a mudanÃ§a em cada estatÃ­stica.</li><li><strong>Ver HistÃ³rico:</strong> Clique no Ã­cone <i class="fas fa-history text-indigo-400"></i> em qualquer linha para ver o histÃ³rico completo de atualizaÃ§Ãµes de um jogador, incluindo um grÃ¡fico de crescimento. VocÃª tambÃ©m pode clicar nos pequenos nÃºmeros de crescimento.</li><li><strong>Reverter Erros:</strong> Dentro do registro de histÃ³rico, clique no botÃ£o 'Reverter' em uma entrada antiga para restaurar essas estatÃ­sticas.</li><li><strong>ComparaÃ§Ã£o RÃ¡pida:</strong> DÃª um duplo clique em qualquer lugar na linha de um jogador para abrir um grÃ¡fico comparando suas estatÃ­sticas com a mÃ©dia da alianÃ§a.</li><li><strong>Multi-ComparaÃ§Ã£o:</strong> Use as caixas de seleÃ§Ã£o Ã  esquerda para selecionar atÃ© 5 jogadores, depois clique no botÃ£o 'Comparar Selecionados' para vÃª-los todos em um grÃ¡fico.</li><li><strong>Analisar a AlianÃ§a:</strong> Clique no botÃ£o 'AnÃ¡lises da AlianÃ§a' para uma visÃ£o geral de alto nÃ­vel, incluindo os melhores jogadores e a composiÃ§Ã£o estratÃ©gica.</li>`
            },
            tr: {
                main_title: "Ä°ttifak Ä°statistik KarÅŸÄ±laÅŸtÄ±rmasÄ±", db_connecting: "VeritabanÄ±na baÄŸlanÄ±lÄ±yor...", db_connected: "âœ… BaÄŸlandÄ±", instructions_title: "Talimatlar ve Bilgiler", rule1: "Kural 1: AKTÄ°F BUFF YOK.", rule2: "Kural 2: ASKERÄ° OLMAYAN bir yan hesaba deneme saldÄ±rÄ±sÄ± yapÄ±n.", rule3: "Kural 3: Seviye 5 Stand of Arms becerisine sahip 4 Chenko kullanÄ±n.", rule4: "Kural 4: Haftada en az bir kez gÃ¼ncelleyin.", entry_title: "Manuel Veri GiriÅŸi", entry_tip: "Ä°pucu: Girdiler arasÄ±nda sÄ±rayla ilerlemek iÃ§in 'Tab' veya 'Enter' kullanÄ±n.", player_name: "Oyuncu AdÄ±", player_name_placeholder: "Oyuncu adÄ±nÄ± girin", save_stats: "Ä°statistikleri Kaydet", cancel: "Ä°ptal", infantry: "Piyade", cavalry: "SÃ¼vari", archer: "OkÃ§u", chart_title: "Ä°ttifak KarÅŸÄ±laÅŸtÄ±rma Tablosu", analytics: "Ä°ttifak Analizi", compare_selected: "SeÃ§ilenleri KarÅŸÄ±laÅŸtÄ±r", th_player: "Oyuncu", th_inf_att: "Piyade Sal", th_inf_def: "Piyade Sav", th_inf_let: "Piyade Ã–lÃ¼m", th_inf_hp: "Piyade Can", th_cav_att: "SÃ¼vari Sal", th_cav_def: "SÃ¼vari Sav", th_cav_let: "SÃ¼vari Ã–lÃ¼m", th_cav_hp: "SÃ¼vari Can", th_arc_att: "OkÃ§u Sal", th_arc_def: "OkÃ§u Sav", th_arc_let: "OkÃ§u Ã–lÃ¼m", th_arc_hp: "OkÃ§u Can", th_true_score: "GerÃ§ek Puan", th_real_score: "Ham Puan", th_last_update: "Son GÃ¼ncelleme", th_actions: "Eylemler", confirm: "Onayla", history_graph_title: "Zaman Ä°Ã§inde Ham Puan", all_time: "TÃ¼m Zamanlar", last_month: "GeÃ§en Ay", last_3_months: "Son 3 Ay", last_6_months: "Son 6 Ay", last_year: "GeÃ§en YÄ±l", update_stats: "Ä°statistikleri GÃ¼ncelle", confirm_deletion_title: "Silmeyi Onayla", confirm_deletion_msg: "{playerName} iÃ§in TÃœM giriÅŸler silinecek. Bu iÅŸlem geri alÄ±namaz. Emin misiniz?", confirm_revert_title: "Geri AlmayÄ± Onayla", confirm_revert_msg: "Bu, bu geÃ§miÅŸ girdisindeki istatistikleri kopyalayacak ve {playerName} iÃ§in en yeni girdi olarak kaydedecektir. Bu iÅŸlem yÄ±kÄ±cÄ± deÄŸildir. Emin misiniz?", revert: "Geri Al", history_for: "{playerName} iÃ§in GÃ¼ncelleme GeÃ§miÅŸi", real_score_label: "Ham Puan:", top_10_rally: "En Ä°yi 10 SaldÄ±rÄ± Lideri (GerÃ§ek Puana gÃ¶re)", most_improved: "En Ã‡ok GeliÅŸen Oyuncular (Ham Puana gÃ¶re)", no_history: "HenÃ¼z yeterli geÃ§miÅŸ veri yok.", alliance_comp: "Ä°ttifak Kompozisyonu", top_5_inf: "En Ä°yi 5 Piyade Oyuncusu", top_5_cav: "En Ä°yi 5 SÃ¼vari Oyuncusu", top_5_arc: "En Ä°yi 5 OkÃ§u Oyuncusu", last_5_entries: "Son 5 Yeni Girdi", submitted_on: "gÃ¶nderilme tarihi", no_entries_yet: "HenÃ¼z giriÅŸ yok.", features: "Ã–zellikler", changelog: "DeÄŸiÅŸiklik GÃ¼nlÃ¼ÄŸÃ¼", help_title: "Bu Panoyu NasÄ±l KullanÄ±rÄ±m", help_list: `<li><strong>AÄŸÄ±rlÄ±klÄ± SÄ±ralama:</strong> 'GerÃ§ek Puan', oyuncularÄ± SaldÄ±rÄ±/Savunma'dan daha Ã§ok Ã–lÃ¼mcÃ¼llÃ¼k (x1.2) ve Can (x1.1) deÄŸerlerine gÃ¶re sÄ±ralayan bir formÃ¼le dayanmaktadÄ±r.</li><li><strong>Ä°lerlemeyi Takip Et:</strong> Bir gÃ¼ncellemeden sonra, kÃ¼Ã§Ã¼k <span class="text-green-400">(+yeÅŸil)</span> veya <span class="text-red-400">(-kÄ±rmÄ±zÄ±)</span> sayÄ±lar her istatistikteki deÄŸiÅŸikliÄŸi gÃ¶sterir.</li><li><strong>GeÃ§miÅŸi GÃ¶rÃ¼ntÃ¼le:</strong> Bir oyuncunun bÃ¼yÃ¼me grafiÄŸi de dahil olmak Ã¼zere tam gÃ¼ncelleme geÃ§miÅŸini gÃ¶rmek iÃ§in herhangi bir satÄ±rdaki <i class="fas fa-history text-indigo-400"></i> simgesine tÄ±klayÄ±n. AyrÄ±ca kÃ¼Ã§Ã¼k bÃ¼yÃ¼me sayÄ±larÄ±na da tÄ±klayabilirsiniz.</li><li><strong>HatalarÄ± Geri Al:</strong> GeÃ§miÅŸ gÃ¼nlÃ¼ÄŸÃ¼nde, eski bir girdideki 'Geri Al' dÃ¼ÄŸmesine tÄ±klayarak bu istatistikleri geri yÃ¼kleyin.</li><li><strong>HÄ±zlÄ± KarÅŸÄ±laÅŸtÄ±rma:</strong> Bir oyuncunun satÄ±rÄ±nda herhangi bir yere Ã§ift tÄ±klayarak istatistiklerini ittifak ortalamasÄ±yla karÅŸÄ±laÅŸtÄ±ran bir grafik aÃ§Ä±n.</li><li><strong>Ã‡oklu KarÅŸÄ±laÅŸtÄ±rma:</strong> En fazla 5 oyuncu seÃ§mek iÃ§in soldaki onay kutularÄ±nÄ± kullanÄ±n, ardÄ±ndan hepsini tek bir grafikte gÃ¶rmek iÃ§in 'SeÃ§ilenleri KarÅŸÄ±laÅŸtÄ±r' dÃ¼ÄŸmesine tÄ±klayÄ±n.</li><li><strong>Ä°ttifakÄ± Analiz Et:</strong> En iyi oyuncular ve stratejik kompozisyon dahil olmak Ã¼zere Ã¼st dÃ¼zey bir genel bakÄ±ÅŸ iÃ§in 'Ä°ttifak Analizi' dÃ¼ÄŸmesine tÄ±klayÄ±n.</li>`
            },
            ko: {
                main_title: "ë™ë§¹ í†µê³„ ë¹„êµ", db_connecting: "ë°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²° ì¤‘...", db_connected: "âœ… ì—°ê²°ë¨", instructions_title: "ì§€ì¹¨ ë° ì •ë³´", rule1: "ê·œì¹™ 1: ë²„í”„ ì—†ìŒ", rule2: "ê·œì¹™ 2: ë³‘ë ¥ ì—†ëŠ” ë¶€ê³„ì •ìœ¼ë¡œ ì§‘ê²° í…ŒìŠ¤íŠ¸", rule3: "ê·œì¹™ 3: 5ë ˆë²¨ ìŠ¤í‚¬ì„ ê°€ì§„ ì²¸ì½” 4ëª… ì‚¬ìš©", rule4: "ê·œì¹™ 4: ìµœì†Œ ì£¼ 1íšŒ ì—…ë°ì´íŠ¸", entry_title: "ìˆ˜ë™ ë°ì´í„° ì…ë ¥", entry_tip: "íŒ: 'Tab' ë˜ëŠ” 'Enter'ë¥¼ ì‚¬ìš©í•˜ì—¬ ìˆœì„œëŒ€ë¡œ ì´ë™", player_name: "í”Œë ˆì´ì–´ ì´ë¦„", player_name_placeholder: "í”Œë ˆì´ì–´ ì´ë¦„ ì…ë ¥", save_stats: "í†µê³„ ì €ì¥", cancel: "ì·¨ì†Œ", infantry: "ë³´ë³‘", cavalry: "ê¸°ë³‘", archer: "ê¶ìˆ˜", chart_title: "ë™ë§¹ ë¹„êµ ì°¨íŠ¸", analytics: "ë™ë§¹ ë¶„ì„", compare_selected: "ì„ íƒ í•­ëª© ë¹„êµ", th_player: "í”Œë ˆì´ì–´", th_inf_att: "ë³´ë³‘ ê³µê²©", th_inf_def: "ë³´ë³‘ ë°©ì–´", th_inf_let: "ë³´ë³‘ ì¹˜ëª…", th_inf_hp: "ë³´ë³‘ ì²´ë ¥", th_cav_att: "ê¸°ë³‘ ê³µê²©", th_cav_def: "ê¸°ë³‘ ë°©ì–´", th_cav_let: "ê¸°ë³‘ ì¹˜ëª…", th_cav_hp: "ê¸°ë³‘ ì²´ë ¥", th_arc_att: "ê¶ìˆ˜ ê³µê²©", th_arc_def: "ê¶ìˆ˜ ë°©ì–´", th_arc_let: "ê¶ìˆ˜ ì¹˜ëª…", th_arc_hp: "ê¶ìˆ˜ ì²´ë ¥", th_true_score: "ì§„ì •í•œ ì ìˆ˜", th_real_score: "ì‹¤ì œ ì ìˆ˜", th_last_update: "ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸", th_actions: "ì‘ì—…", confirm: "í™•ì¸", history_graph_title: "ì‹œê°„ì— ë”°ë¥¸ ì‹¤ì œ ì ìˆ˜", all_time: "ëª¨ë“  ì‹œê°„", last_month: "ì§€ë‚œ ë‹¬", last_3_months: "ì§€ë‚œ 3ê°œì›”", last_6_months: "ì§€ë‚œ 6ê°œì›”", last_year: "ì‘ë…„", update_stats: "í†µê³„ ì—…ë°ì´íŠ¸", confirm_deletion_title: "ì‚­ì œ í™•ì¸", confirm_deletion_msg: "{playerName}ì˜ ëª¨ë“  í•­ëª©ì„ ì‚­ì œí•©ë‹ˆë‹¤. ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. í™•ì‹¤í•©ë‹ˆê¹Œ?", confirm_revert_title: "ë³µì› í™•ì¸", confirm_revert_msg: "ì´ ê¸°ë¡ í•­ëª©ì˜ í†µê³„ë¥¼ ë³µì‚¬í•˜ì—¬ {playerName}ì˜ ìµœì‹  í•­ëª©ìœ¼ë¡œ ì €ì¥í•©ë‹ˆë‹¤. ì´ ì‘ì—…ì€ íŒŒê´´ì ì´ì§€ ì•ŠìŠµë‹ˆë‹¤. í™•ì‹¤í•©ë‹ˆê¹Œ?", revert: "ë³µì›", history_for: "{playerName}ì˜ ì—…ë°ì´íŠ¸ ê¸°ë¡", real_score_label: "ì‹¤ì œ ì ìˆ˜:", top_10_rally: "ìƒìœ„ 10 ì§‘ê²° ì§€íœ˜ê´€ (ì§„ì •í•œ ì ìˆ˜ ê¸°ì¤€)", most_improved: "ê°€ì¥ ë§ì´ ë°œì „í•œ í”Œë ˆì´ì–´ (ì‹¤ì œ ì ìˆ˜ ê¸°ì¤€)", no_history: "ì•„ì§ ì¶©ë¶„í•œ ê¸°ë¡ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.", alliance_comp: "ë™ë§¹ êµ¬ì„±", top_5_inf: "ìƒìœ„ 5 ë³´ë³‘ í”Œë ˆì´ì–´", top_5_cav: "ìƒìœ„ 5 ê¸°ë³‘ í”Œë ˆì´ì–´", top_5_arc: "ìƒìœ„ 5 ê¶ìˆ˜ í”Œë ˆì´ì–´", last_5_entries: "ìµœê·¼ 5ê°œ ìƒˆ í•­ëª©", submitted_on: "ì œì¶œ ë‚ ì§œ", no_entries_yet: "ì•„ì§ í•­ëª© ì—†ìŒ", features: "ê¸°ëŠ¥", changelog: "ë³€ê²½ ë¡œê·¸", help_title: "ì´ ëŒ€ì‹œë³´ë“œ ì‚¬ìš© ë°©ë²•", help_list: `<li><strong>ê°€ì¤‘ì¹˜ ìˆœìœ„:</strong> 'ì§„ì •í•œ ì ìˆ˜'ëŠ” ê³µê²©/ë°©ì–´ë³´ë‹¤ ì¹˜ëª…íƒ€(x1.2) ë° ì²´ë ¥(x1.1)ì„ ë” ì¤‘ìš”í•˜ê²Œ ìƒê°í•˜ëŠ” ê³µì‹ì— ë”°ë¼ í”Œë ˆì´ì–´ ìˆœìœ„ë¥¼ ë§¤ê¹ë‹ˆë‹¤.</li><li><strong>ì§„í–‰ ìƒí™© ì¶”ì :</strong> ì—…ë°ì´íŠ¸ í›„ ì‘ì€ <span class="text-green-400">(+ë…¹ìƒ‰)</span> ë˜ëŠ” <span class="text-red-400">(-ë¹¨ê°„ìƒ‰)</span> ìˆ«ìëŠ” ê° í†µê³„ì˜ ë³€ê²½ ì‚¬í•­ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.</li><li><strong>ê¸°ë¡ ë³´ê¸°:</strong> ì•„ë¬´ í–‰ì˜ <i class="fas fa-history text-indigo-400"></i> ì•„ì´ì½˜ì„ í´ë¦­í•˜ì—¬ ì„±ì¥ ì°¨íŠ¸ë¥¼ í¬í•¨í•œ í”Œë ˆì´ì–´ì˜ ì „ì²´ ì—…ë°ì´íŠ¸ ê¸°ë¡ì„ í™•ì¸í•˜ì„¸ìš”. ì‘ì€ ì„±ì¥ ìˆ«ìë¥¼ í´ë¦­í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.</li><li><strong>ì‹¤ìˆ˜ ë˜ëŒë¦¬ê¸°:</strong> ê¸°ë¡ ë¡œê·¸ ë‚´ì—ì„œ ì´ì „ í•­ëª©ì˜ 'ë³µì›' ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ í•´ë‹¹ í†µê³„ë¥¼ ë³µì›í•©ë‹ˆë‹¤.</li><li><strong>ë¹ ë¥¸ ë¹„êµ:</strong> í”Œë ˆì´ì–´ í–‰ì˜ ì•„ë¬´ ê³³ì´ë‚˜ ë‘ ë²ˆ í´ë¦­í•˜ì—¬ í•´ë‹¹ í†µê³„ë¥¼ ë™ë§¹ í‰ê· ê³¼ ë¹„êµí•˜ëŠ” ì°¨íŠ¸ë¥¼ ì—½ë‹ˆë‹¤.</li><li><strong>ë‹¤ì¤‘ ë¹„êµ:</strong> ì™¼ìª½ì˜ í™•ì¸ë€ì„ ì‚¬ìš©í•˜ì—¬ ìµœëŒ€ 5ëª…ì˜ í”Œë ˆì´ì–´ë¥¼ ì„ íƒí•œ ë‹¤ìŒ 'ì„ íƒ í•­ëª© ë¹„êµ' ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ëª¨ë‘ í•œ ì°¨íŠ¸ì—ì„œ í™•ì¸í•˜ì„¸ìš”.</li><li><strong>ë™ë§¹ ë¶„ì„:</strong> ìµœê³  í”Œë ˆì´ì–´ ë° ì „ëµì  êµ¬ì„±ì„ í¬í•¨í•œ ìƒìœ„ ìˆ˜ì¤€ ê°œìš”ë¥¼ ë³´ë ¤ë©´ 'ë™ë§¹ ë¶„ì„' ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.</li>`
            },
            fr: {
                main_title: "Comparaison des statistiques de l'alliance", db_connecting: "Connexion Ã  la base de donnÃ©es...", db_connected: "âœ… ConnectÃ©", instructions_title: "Instructions et informations", rule1: "RÃ¨gle 1 : AUCUN BUFF actif.", rule2: "RÃ¨gle 2 : Tester un ralliement sur un compte secondaire SANS troupes.", rule3: "RÃ¨gle 3 : Utiliser 4 Chenkos avec la compÃ©tence 'Stand of Arms' niveau 5.", rule4: "RÃ¨gle 4 : Mettre Ã  jour au moins une fois par semaine.", entry_title: "Saisie manuelle des donnÃ©es", entry_tip: "Astuce : Utilisez 'Tab' ou 'EntrÃ©e' pour vous dÃ©placer dans les champs.", player_name: "Nom du joueur", player_name_placeholder: "Entrez le nom du joueur", save_stats: "Enregistrer", cancel: "Annuler", infantry: "Infanterie", cavalry: "Cavalerie", archer: "Archer", chart_title: "Tableau de comparaison de l'alliance", analytics: "Analyses de l'alliance", compare_selected: "Comparer la sÃ©lection", th_player: "Joueur", th_inf_att: "Att Inf", th_inf_def: "DÃ©f Inf", th_inf_let: "LÃ©t Inf", th_inf_hp: "PV Inf", th_cav_att: "Att Cav", th_cav_def: "DÃ©f Cav", th_cav_let: "LÃ©t Cav", th_cav_hp: "PV Cav", th_arc_att: "Att Arc", th_arc_def: "DÃ©f Arc", th_arc_let: "LÃ©t Arc", th_arc_hp: "PV Arc", th_true_score: "Score rÃ©el", th_real_score: "Score brut", th_last_update: "DerniÃ¨re MÃ J", th_actions: "Actions", confirm: "Confirmer", history_graph_title: "Score brut au fil du temps", all_time: "Toujours", last_month: "Le mois dernier", last_3_months: "Les 3 derniers mois", last_6_months: "Les 6 derniers mois", last_year: "L'annÃ©e derniÃ¨re", update_stats: "Mettre Ã  jour", confirm_deletion_title: "Confirmer la suppression", confirm_deletion_msg: "Ceci supprimera TOUTES les entrÃ©es pour {playerName}. Cette action est irrÃ©versible. ÃŠtes-vous sÃ»r ?", confirm_revert_title: "Confirmer l'annulation", confirm_revert_msg: "Ceci copiera les statistiques de cette entrÃ©e historique et l'enregistrera comme la nouvelle entrÃ©e la plus rÃ©cente pour {playerName}. Cette action n'est pas destructive. ÃŠtes-vous sÃ»r ?", revert: "Annuler", history_for: "Historique des mises Ã  jour pour {playerName}", real_score_label: "Score brut:", top_10_rally: "Top 10 des leaders de ralliement (par score rÃ©el)", most_improved: "Joueurs les plus amÃ©liorÃ©s (par score brut)", no_history: "Pas encore assez de donnÃ©es historiques.", alliance_comp: "Composition de l'alliance", top_5_inf: "Top 5 des joueurs d'infanterie", top_5_cav: "Top 5 des joueurs de cavalerie", top_5_arc: "Top 5 des joueurs d'archer", last_5_entries: "5 derniÃ¨res entrÃ©es", submitted_on: "soumis le", no_entries_yet: "Aucune entrÃ©e pour le moment.", features: "FonctionnalitÃ©s", changelog: "Journal des modifications", help_title: "Comment utiliser ce tableau de bord", help_list: `<li><strong>Classement pondÃ©rÃ© :</strong> Le 'Score rÃ©el' classe les joueurs selon une formule qui valorise davantage la LÃ©talitÃ© (x1.2) et la SantÃ© (x1.1) que l'Attaque/DÃ©fense.</li><li><strong>Suivre la progression :</strong> AprÃ¨s une mise Ã  jour, de petits chiffres <span class="text-green-400">(+verts)</span> ou <span class="text-red-400">(-rouges)</span> indiquent le changement de chaque statistique.</li><li><strong>Voir l'historique :</strong> Cliquez sur l'icÃ´ne <i class="fas fa-history text-indigo-400"></i> sur n'importe quelle ligne pour voir l'historique complet des mises Ã  jour d'un joueur, y compris un graphique de croissance. Vous pouvez Ã©galement cliquer sur les petits chiffres de croissance.</li><li><strong>Annuler les erreurs :</strong> Dans le journal de l'historique, cliquez sur le bouton 'Annuler' d'une ancienne entrÃ©e pour restaurer ces statistiques.</li><li><strong>Comparaison rapide :</strong> Double-cliquez n'importe oÃ¹ sur la ligne d'un joueur pour ouvrir un graphique comparant ses statistiques Ã  la moyenne de l'alliance.</li><li><strong>Comparaison multiple :</strong> Utilisez les cases Ã  cocher Ã  gauche pour sÃ©lectionner jusqu'Ã  5 joueurs, puis cliquez sur le bouton 'Comparer la sÃ©lection' pour les voir tous sur un seul graphique.</li><li><strong>Analyser l'alliance :</strong> Cliquez sur le bouton 'Analyses de l'alliance' pour un aperÃ§u de haut niveau, incluant les meilleurs joueurs et la composition stratÃ©gique.</li>`
            },
            fa: {
                main_title: "Ù…Ù‚Ø§ÛŒØ³Ù‡ Ø¢Ù…Ø§Ø± Ø§ØªØ­Ø§Ø¯", db_connecting: "Ø¯Ø± Ø­Ø§Ù„ Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ù¾Ø§ÛŒÚ¯Ø§Ù‡ Ø¯Ø§Ø¯Ù‡...", db_connected: "âœ… Ù…ØªØµÙ„ Ø´Ø¯", instructions_title: "Ø¯Ø³ØªÙˆØ±Ø§Ù„Ø¹Ù…Ù„ Ùˆ Ø§Ø·Ù„Ø§Ø¹Ø§Øª", rule1: "Ù‚Ø§Ù†ÙˆÙ† Û±: Ù‡ÛŒÚ† BUFF ÙØ¹Ø§Ù„ÛŒ Ù†Ø¨Ø§Ø´Ø¯.", rule2: "Ù‚Ø§Ù†ÙˆÙ† Û²: ÛŒÚ© Ø­Ù…Ù„Ù‡ Ø¢Ø²Ù…Ø§ÛŒØ´ÛŒ Ø¨Ù‡ ÛŒÚ© Ø­Ø³Ø§Ø¨ ÙØ±Ø¹ÛŒ Ø¨Ø¯ÙˆÙ† Ù†ÛŒØ±Ùˆ Ø§Ù†Ø¬Ø§Ù… Ø¯Ù‡ÛŒØ¯.", rule3: "Ù‚Ø§Ù†ÙˆÙ† Û³: Ø§Ø² Û´ Ú†Ù†Ú©Ùˆ Ø¨Ø§ Ù…Ù‡Ø§Ø±Øª Ø³Ø·Ø­ Ûµ Stand of Arms Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.", rule4: "Ù‚Ø§Ù†ÙˆÙ† Û´: Ø­Ø¯Ø§Ù‚Ù„ Ù‡ÙØªÙ‡â€ŒØ§ÛŒ ÛŒÚ©â€ŒØ¨Ø§Ø± Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ú©Ù†ÛŒØ¯.", entry_title: "ÙˆØ±ÙˆØ¯ Ø¯Ø³ØªÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§", entry_tip: "Ù†Ú©ØªÙ‡: Ø¨Ø±Ø§ÛŒ Ø¬Ø§Ø¨Ø¬Ø§ÛŒÛŒ Ø¨ÛŒÙ† ÙˆØ±ÙˆØ¯ÛŒâ€ŒÙ‡Ø§ Ø§Ø² 'Tab' ÛŒØ§ 'Enter' Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.", player_name: "Ù†Ø§Ù… Ø¨Ø§Ø²ÛŒÚ©Ù†", player_name_placeholder: "Ù†Ø§Ù… Ø¨Ø§Ø²ÛŒÚ©Ù† Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯", save_stats: "Ø°Ø®ÛŒØ±Ù‡ Ø¢Ù…Ø§Ø±", cancel: "Ù„ØºÙˆ", infantry: "Ù¾ÛŒØ§Ø¯Ù‡â€ŒÙ†Ø¸Ø§Ù…", cavalry: "Ø³ÙˆØ§Ø±Ø§Ù†", archer: "Ú©Ù…Ø§Ù†Ø¯Ø§Ø±Ø§Ù†", chart_title: "Ù†Ù…ÙˆØ¯Ø§Ø± Ù…Ù‚Ø§ÛŒØ³Ù‡ Ø§ØªØ­Ø§Ø¯", analytics: "ØªØ­Ù„ÛŒÙ„ Ø§ØªØ­Ø§Ø¯", compare_selected: "Ù…Ù‚Ø§ÛŒØ³Ù‡ Ø§Ù†ØªØ®Ø§Ø¨â€ŒØ´Ø¯Ù‡â€ŒÙ‡Ø§", th_player: "Ø¨Ø§Ø²ÛŒÚ©Ù†", th_inf_att: "Ø­Ù…Ù„Ù‡ Ù¾ÛŒØ§Ø¯Ù‡", th_inf_def: "Ø¯ÙØ§Ø¹ Ù¾ÛŒØ§Ø¯Ù‡", th_inf_let: "Ú©Ø´Ù†Ø¯Ú¯ÛŒ Ù¾ÛŒØ§Ø¯Ù‡", th_inf_hp: "Ø³Ù„Ø§Ù…ØªÛŒ Ù¾ÛŒØ§Ø¯Ù‡", th_cav_att: "Ø­Ù…Ù„Ù‡ Ø³ÙˆØ§Ø±Ø§Ù†", th_cav_def: "Ø¯ÙØ§Ø¹ Ø³ÙˆØ§Ø±Ø§Ù†", th_cav_let: "Ú©Ø´Ù†Ø¯Ú¯ÛŒ Ø³ÙˆØ§Ø±Ø§Ù†", th_cav_hp: "Ø³Ù„Ø§Ù…ØªÛŒ Ø³ÙˆØ§Ø±Ø§Ù†", th_arc_att: "Ø­Ù…Ù„Ù‡ Ú©Ù…Ø§Ù†Ø¯Ø§Ø±Ø§Ù†", th_arc_def: "Ø¯ÙØ§Ø¹ Ú©Ù…Ø§Ù†Ø¯Ø§Ø±Ø§Ù†", th_arc_let: "Ú©Ø´Ù†Ø¯Ú¯ÛŒ Ú©Ù…Ø§Ù†Ø¯Ø§Ø±Ø§Ù†", th_arc_hp: "Ø³Ù„Ø§Ù…ØªÛŒ Ú©Ù…Ø§Ù†Ø¯Ø§Ø±Ø§Ù†", th_true_score: "Ø§Ù…ØªÛŒØ§Ø² ÙˆØ§Ù‚Ø¹ÛŒ", th_real_score: "Ø§Ù…ØªÛŒØ§Ø² Ø®Ø§Ù…", th_last_update: "Ø¢Ø®Ø±ÛŒÙ† Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ", th_actions: "Ø§Ù‚Ø¯Ø§Ù…Ø§Øª", confirm: "ØªØ§ÛŒÛŒØ¯", history_graph_title: "Ø§Ù…ØªÛŒØ§Ø² Ø®Ø§Ù… Ø¯Ø± Ø·ÙˆÙ„ Ø²Ù…Ø§Ù†", all_time: "Ù‡Ù…Ù‡ Ø²Ù…Ø§Ù†â€ŒÙ‡Ø§", last_month: "Ù…Ø§Ù‡ Ú¯Ø°Ø´ØªÙ‡", last_3_months: "Û³ Ù…Ø§Ù‡ Ú¯Ø°Ø´ØªÙ‡", last_6_months: "Û¶ Ù…Ø§Ù‡ Ú¯Ø°Ø´ØªÙ‡", last_year: "Ø³Ø§Ù„ Ú¯Ø°Ø´ØªÙ‡", update_stats: "Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¢Ù…Ø§Ø±", confirm_deletion_title: "ØªØ§ÛŒÛŒØ¯ Ø­Ø°Ù", confirm_deletion_msg: "Ø§ÛŒÙ† Ú©Ø§Ø± ØªÙ…Ø§Ù… ÙˆØ±ÙˆØ¯ÛŒâ€ŒÙ‡Ø§ÛŒ {playerName} Ø±Ø§ Ø­Ø°Ù Ù…ÛŒâ€ŒÚ©Ù†Ø¯. Ø§ÛŒÙ† Ø¹Ù…Ù„ Ù‚Ø§Ø¨Ù„ Ø¨Ø§Ø²Ú¯Ø´Øª Ù†ÛŒØ³Øª. Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ØŸ", confirm_revert_title: "ØªØ§ÛŒÛŒØ¯ Ø¨Ø§Ø²Ú¯Ø±Ø¯Ø§Ù†ÛŒ", confirm_revert_msg: "Ø§ÛŒÙ† Ú©Ø§Ø± Ø¢Ù…Ø§Ø± Ø§ÛŒÙ† ÙˆØ±ÙˆØ¯ÛŒ ØªØ§Ø±ÛŒØ®ÛŒ Ø±Ø§ Ú©Ù¾ÛŒ Ú©Ø±Ø¯Ù‡ Ùˆ Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† Ø¬Ø¯ÛŒØ¯ØªØ±ÛŒÙ† ÙˆØ±ÙˆØ¯ÛŒ Ø¨Ø±Ø§ÛŒ {playerName} Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒâ€ŒÚ©Ù†Ø¯. Ø§ÛŒÙ† Ø¹Ù…Ù„ Ù…Ø®Ø±Ø¨ Ù†ÛŒØ³Øª. Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ØŸ", revert: "Ø¨Ø§Ø²Ú¯Ø±Ø¯Ø§Ù†ÛŒ", history_for: "ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¨Ø±Ø§ÛŒ {playerName}", real_score_label: "Ø§Ù…ØªÛŒØ§Ø² Ø®Ø§Ù…:", top_10_rally: "Û±Û° Ø±Ù‡Ø¨Ø± Ø¨Ø±ØªØ± Ø­Ù…Ù„Ù‡ (Ø¨Ø± Ø§Ø³Ø§Ø³ Ø§Ù…ØªÛŒØ§Ø² ÙˆØ§Ù‚Ø¹ÛŒ)", most_improved: "Ø¨Ø§Ø²ÛŒÚ©Ù†Ø§Ù† Ø¨Ø§ Ø¨ÛŒØ´ØªØ±ÛŒÙ† Ù¾ÛŒØ´Ø±ÙØª (Ø¨Ø± Ø§Ø³Ø§Ø³ Ø§Ù…ØªÛŒØ§Ø² Ø®Ø§Ù…)", no_history: "Ù‡Ù†ÙˆØ² Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ ØªØ§Ø±ÛŒØ®ÛŒ Ú©Ø§ÙÛŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯.", alliance_comp: "ØªØ±Ú©ÛŒØ¨ Ø§ØªØ­Ø§Ø¯", top_5_inf: "Ûµ Ø¨Ø§Ø²ÛŒÚ©Ù† Ø¨Ø±ØªØ± Ù¾ÛŒØ§Ø¯Ù‡â€ŒÙ†Ø¸Ø§Ù…", top_5_cav: "Ûµ Ø¨Ø§Ø²ÛŒÚ©Ù† Ø¨Ø±ØªØ± Ø³ÙˆØ§Ø±Ø§Ù†", top_5_arc: "Ûµ Ø¨Ø§Ø²ÛŒÚ©Ù† Ø¨Ø±ØªØ± Ú©Ù…Ø§Ù†Ø¯Ø§Ø±Ø§Ù†", last_5_entries: "Ûµ ÙˆØ±ÙˆØ¯ÛŒ Ø¬Ø¯ÛŒØ¯ Ø§Ø®ÛŒØ±", submitted_on: "Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯Ù‡ Ø¯Ø±", no_entries_yet: "Ù‡Ù†ÙˆØ² ÙˆØ±ÙˆØ¯ÛŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯.", features: "ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§", changelog: "Ú¯Ø²Ø§Ø±Ø´ ØªØºÛŒÛŒØ±Ø§Øª", help_title: "Ù†Ø­ÙˆÙ‡ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø§ÛŒÙ† Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯", help_list: `<li><strong>Ø±ØªØ¨Ù‡â€ŒØ¨Ù†Ø¯ÛŒ ÙˆØ²Ù†ÛŒ:</strong> 'Ø§Ù…ØªÛŒØ§Ø² ÙˆØ§Ù‚Ø¹ÛŒ' Ø¨Ø§Ø²ÛŒÚ©Ù†Ø§Ù† Ø±Ø§ Ø¨Ø± Ø§Ø³Ø§Ø³ ÙØ±Ù…ÙˆÙ„ÛŒ Ø±ØªØ¨Ù‡â€ŒØ¨Ù†Ø¯ÛŒ Ù…ÛŒâ€ŒÚ©Ù†Ø¯ Ú©Ù‡ Ø¨Ù‡ Ú©Ø´Ù†Ø¯Ú¯ÛŒ (x1.2) Ùˆ Ø³Ù„Ø§Ù…ØªÛŒ (x1.1) Ø¨ÛŒØ´ØªØ± Ø§Ø² Ø­Ù…Ù„Ù‡/Ø¯ÙØ§Ø¹ Ø§Ø±Ø²Ø´ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯.</li><li><strong>Ù¾ÛŒÚ¯ÛŒØ±ÛŒ Ù¾ÛŒØ´Ø±ÙØª:</strong> Ù¾Ø³ Ø§Ø² Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒØŒ Ø§Ø¹Ø¯Ø§Ø¯ Ú©ÙˆÚ†Ú© <span class="text-green-400">(+Ø³Ø¨Ø²)</span> ÛŒØ§ <span class="text-red-400">(-Ù‚Ø±Ù…Ø²)</span> ØªØºÛŒÛŒØ± Ø¯Ø± Ù‡Ø± Ø¢Ù…Ø§Ø± Ø±Ø§ Ù†Ø´Ø§Ù† Ù…ÛŒâ€ŒØ¯Ù‡Ù†Ø¯.</li><li><strong>Ù…Ø´Ø§Ù‡Ø¯Ù‡ ØªØ§Ø±ÛŒØ®Ú†Ù‡:</strong> Ø±ÙˆÛŒ Ù†Ù…Ø§Ø¯ <i class="fas fa-history text-indigo-400"></i> Ø¯Ø± Ù‡Ø± Ø±Ø¯ÛŒÙ Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯ ØªØ§ ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ú©Ø§Ù…Ù„ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¨Ø§Ø²ÛŒÚ©Ù† Ø±Ø§ Ø¨Ù‡ Ù‡Ù…Ø±Ø§Ù‡ Ù†Ù…ÙˆØ¯Ø§Ø± Ø±Ø´Ø¯ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ú©Ù†ÛŒØ¯. Ù‡Ù…Ú†Ù†ÛŒÙ† Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø±ÙˆÛŒ Ø§Ø¹Ø¯Ø§Ø¯ Ø±Ø´Ø¯ Ú©ÙˆÚ†Ú© Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯.</li><li><strong>Ø¨Ø§Ø²Ú¯Ø±Ø¯Ø§Ù†ÛŒ Ø§Ø´ØªØ¨Ø§Ù‡Ø§Øª:</strong> Ø¯Ø± Ú¯Ø²Ø§Ø±Ø´ ØªØ§Ø±ÛŒØ®Ú†Ù‡ØŒ Ø±ÙˆÛŒ Ø¯Ú©Ù…Ù‡ 'Ø¨Ø§Ø²Ú¯Ø±Ø¯Ø§Ù†ÛŒ' Ø¯Ø± ÛŒÚ© ÙˆØ±ÙˆØ¯ÛŒ Ù‚Ø¯ÛŒÙ…ÛŒ Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯ ØªØ§ Ø¢Ù† Ø¢Ù…Ø§Ø± Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ Ø´ÙˆØ¯.</li><li><strong>Ù…Ù‚Ø§ÛŒØ³Ù‡ Ø³Ø±ÛŒØ¹:</strong> Ø±ÙˆÛŒ Ù‡Ø± Ø¬Ø§ÛŒ Ø±Ø¯ÛŒÙ Ø¨Ø§Ø²ÛŒÚ©Ù† Ø¯ÙˆØ¨Ø§Ø± Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯ ØªØ§ Ù†Ù…ÙˆØ¯Ø§Ø±ÛŒ Ø¨Ø§Ø² Ø´ÙˆØ¯ Ú©Ù‡ Ø¢Ù…Ø§Ø± Ø§Ùˆ Ø±Ø§ Ø¨Ø§ Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† Ø§ØªØ­Ø§Ø¯ Ù…Ù‚Ø§ÛŒØ³Ù‡ Ù…ÛŒâ€ŒÚ©Ù†Ø¯.</li><li><strong>Ù…Ù‚Ø§ÛŒØ³Ù‡ Ú†Ù†Ø¯Ú¯Ø§Ù†Ù‡:</strong> Ø§Ø² Ú†Ú©â€ŒØ¨Ø§Ú©Ø³â€ŒÙ‡Ø§ÛŒ Ø³Ù…Øª Ú†Ù¾ Ø¨Ø±Ø§ÛŒ Ø§Ù†ØªØ®Ø§Ø¨ Ø­Ø¯Ø§Ú©Ø«Ø± Ûµ Ø¨Ø§Ø²ÛŒÚ©Ù† Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯ØŒ Ø³Ù¾Ø³ Ø±ÙˆÛŒ Ø¯Ú©Ù…Ù‡ 'Ù…Ù‚Ø§ÛŒØ³Ù‡ Ø§Ù†ØªØ®Ø§Ø¨â€ŒØ´Ø¯Ù‡â€ŒÙ‡Ø§' Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯ ØªØ§ Ù‡Ù…Ù‡ Ø¢Ù†Ù‡Ø§ Ø±Ø§ Ø¯Ø± ÛŒÚ© Ù†Ù…ÙˆØ¯Ø§Ø± Ø¨Ø¨ÛŒÙ†ÛŒØ¯.</li><li><strong>ØªØ­Ù„ÛŒÙ„ Ø§ØªØ­Ø§Ø¯:</strong> Ø¨Ø±Ø§ÛŒ Ù…Ø´Ø§Ù‡Ø¯Ù‡ ÛŒÚ© Ù†Ù…Ø§ÛŒ Ú©Ù„ÛŒ Ø³Ø·Ø­ Ø¨Ø§Ù„Ø§ØŒ Ø´Ø§Ù…Ù„ Ø¨Ø§Ø²ÛŒÚ©Ù†Ø§Ù† Ø¨Ø±ØªØ± Ùˆ ØªØ±Ú©ÛŒØ¨ Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒÚ©ØŒ Ø±ÙˆÛŒ Ø¯Ú©Ù…Ù‡ 'ØªØ­Ù„ÛŒÙ„ Ø§ØªØ­Ø§Ø¯' Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯.</li>`
            }
        };
        
        let currentLanguage = 'en';

        const getTranslation = (key) => {
            return translations[currentLanguage][key] || translations.en[key] || key;
        };

        const translateUI = () => {
            document.querySelectorAll('[data-translate-key]').forEach(el => {
                const key = el.getAttribute('data-translate-key');
                if (el.tagName === 'INPUT' && el.placeholder) {
                     el.placeholder = getTranslation(key);
                } else if (el.tagName === 'UL' && key === 'help_list') {
                    el.innerHTML = getTranslation(key);
                }
                else {
                    el.innerHTML = getTranslation(key);
                }
            });
             // Re-render table to apply translations to dynamic parts if any
            if(latestStats.length > 0) renderTable();
        };

        window.setLanguage = (lang) => {
            currentLanguage = lang;
            localStorage.setItem('allianceStatsLanguage', lang);
            document.documentElement.lang = lang;
            document.querySelectorAll('#language-switcher .flag').forEach(f => f.classList.remove('active'));
            document.querySelector(`#language-switcher .flag[data-lang="${lang}"]`).classList.add('active');
            translateUI();
        };
        
        // --- GLOBAL VARIABLES & STATE ---
        let db, auth, userId = null, appId = null;
        let allStats = [];
        let latestStats = [];
        let selectedForComparison = [];
        let currentSort = { column: 'trueScore', direction: 'desc' };
        let currentEditId = null;
        let comparisonChart = null;
        let analyticsChart = null;
        let historyChart = null;
        
        const dbStatus = document.getElementById('db-status');
        const playerNameInput = document.getElementById('playerName');
        const submitBtn = document.getElementById('submit-btn');
        const cancelEditBtn = document.getElementById('cancel-edit-btn');
        const compareBtn = document.getElementById('compare-selected-btn');
        const compareCount = document.getElementById('compare-count');
        
        const modal = document.getElementById('custom-modal');
        const modalConfirmBtn = document.getElementById('modal-confirm-btn');
        const modalCancelBtn = document.getElementById('modal-cancel-btn');
        const modalTitle = document.getElementById('modal-title');
        const modalMessage = document.getElementById('modal-message');

        const historyModal = document.getElementById('history-modal');
        const historyModalTitle = document.getElementById('history-modal-title');
        const historyModalBody = document.getElementById('history-modal-body');
        const historyModalCloseBtn = document.getElementById('history-modal-close-btn');

        const chartModal = document.getElementById('chart-modal');
        const chartModalTitle = document.getElementById('chart-modal-title');
        const chartModalCloseBtn = document.getElementById('chart-modal-close-btn');
        
        const analyticsModal = document.getElementById('analytics-modal');
        const analyticsModalBody = document.getElementById('analytics-modal-body');
        const analyticsModalCloseBtn = document.getElementById('analytics-modal-close-btn');
        const analyticsBtn = document.getElementById('analytics-btn');

        const helpModal = document.getElementById('help-modal');
        const changelogModal = document.getElementById('changelog-modal');

        const initFirebase = async () => {
            const savedLang = localStorage.getItem('allianceStatsLanguage') || 'en';
            setLanguage(savedLang);

            appId = USER_FIREBASE_CONFIG.projectId;
            if (!getApps().length) initializeApp(USER_FIREBASE_CONFIG);
            db = getFirestore();
            auth = getAuth();

            onAuthStateChanged(auth, user => {
                if (user) {
                    userId = user.uid;
                    dbStatus.innerHTML = getTranslation('db_connected');
                    dbStatus.className = 'text-sm text-green-400';
                    setupRealtimeListener();
                } else {
                    signInAnonymously(auth).catch(error => console.error("Auth Failed:", error));
                }
            });
        };
        
        const setupRealtimeListener = () => {
            const collectionPath = `artifacts/${appId}/public/data/game_stats`;
            onSnapshot(collection(db, collectionPath), querySnapshot => {
                allStats = querySnapshot.docs.map(doc => {
                    const data = doc.data();
                    const statEntry = { id: doc.id, ...data, date: data.date ? data.date.toDate() : new Date() };
                    statEntry.trueScore = calculateTrueScore(statEntry);
                    statEntry.realScore = calculateRealScore(statEntry);
                    return statEntry;
                });
                processAndRender();
            });
        };

        const getFormData = () => ({
            playerName: playerNameInput.value.trim().toLowerCase(),
            infAttack: parseFloat(document.getElementById('infAttack').value) || 0,
            infDefense: parseFloat(document.getElementById('infDefense').value) || 0,
            infLethality: parseFloat(document.getElementById('infLethality').value) || 0,
            infHp: parseFloat(document.getElementById('infHp').value) || 0,
            cavAttack: parseFloat(document.getElementById('cavAttack').value) || 0,
            cavDefense: parseFloat(document.getElementById('cavDefense').value) || 0,
            cavLethality: parseFloat(document.getElementById('cavLethality').value) || 0,
            cavHp: parseFloat(document.getElementById('cavHp').value) || 0,
            arcAttack: parseFloat(document.getElementById('arcAttack').value) || 0,
            arcDefense: parseFloat(document.getElementById('arcDefense').value) || 0,
            arcLethality: parseFloat(document.getElementById('arcLethality').value) || 0,
            arcHp: parseFloat(document.getElementById('arcHp').value) || 0,
        });
        
        const processAndRender = () => {
            const playerGroups = {};
            allStats.forEach(stat => {
                const name = stat.playerName.toLowerCase();
                if (!playerGroups[name]) playerGroups[name] = [];
                playerGroups[name].push(stat);
            });

            latestStats = Object.values(playerGroups).map(group => {
                group.sort((a, b) => b.date - a.date);
                return group[0];
            });
            sortAndRender();
        };

        const getSpecialization = (stat) => {
            const troopScores = {
                inf: stat.infAttack + stat.infDefense + stat.infLethality + stat.infHp,
                cav: stat.cavAttack + stat.cavDefense + stat.cavLethality + stat.cavHp,
                arc: stat.arcAttack + stat.arcDefense + stat.arcLethality + stat.arcHp
            };

            const sortedTroops = Object.entries(troopScores).sort((a, b) => b[1] - a[1]);
            const [highestType, highestScore] = sortedTroops[0];
            const [, secondHighestScore] = sortedTroops[1];
            
            if (!secondHighestScore || highestScore < secondHighestScore * 1.10) {
                return { key: 'balanced', icon: 'fa-balance-scale', color: 'text-yellow-500', title: 'Balanced' };
            }

            switch(highestType) {
                case 'inf': return { key: 'infantry', icon: 'fa-shield-alt', color: 'text-blue-400', title: 'Infantry Specialist' };
                case 'cav': return { key: 'cavalry', icon: 'fa-horse', color: 'text-green-400', title: 'Cavalry Specialist' };
                case 'arc': return { key: 'archer', icon: 'fa-bullseye', color: 'text-red-400', title: 'Archer Specialist' };
                default: return { key: 'balanced', icon: 'fa-balance-scale', color: 'text-yellow-500', title: 'Balanced' };
            }
        };

        const renderTable = () => {
            const tableBody = document.getElementById('stats-table-body');
            const rankedStats = latestStats.map((stat, index) => ({ ...stat, rank: index + 1 }));
            const disableCheckboxes = selectedForComparison.length >= 5;

            tableBody.innerHTML = rankedStats.map(stat => {
                const playerHistory = allStats.filter(s => s.playerName === stat.playerName).sort((a, b) => b.date - a.date);
                const previousStat = playerHistory.length > 1 ? playerHistory[1] : null;
                const statKeys = ['infAttack', 'infDefense', 'infLethality', 'infHp', 'cavAttack', 'cavDefense', 'cavLethality', 'cavHp', 'arcAttack', 'arcDefense', 'arcLethality', 'arcHp'];
                
                const statCells = statKeys.map(key => {
                    let deltaHtml = '';
                    if (previousStat) {
                        const delta = (stat[key] - previousStat[key]).toFixed(1);
                        if (delta != 0) {
                           deltaHtml = `<span class="stat-delta ${delta > 0 ? 'text-green-400' : 'text-red-400'}" onclick="event.stopPropagation(); showHistory('${stat.playerName}')">(${delta > 0 ? '+' : ''}${delta})</span>`;
                        }
                    }
                    return `<td>${stat[key]}% ${deltaHtml}</td>`;
                }).join('');

                const isChecked = selectedForComparison.includes(stat.playerName);
                const isDisabled = disableCheckboxes && !isChecked;
                const specialization = getSpecialization(stat);

                const formattedDate = stat.date.toLocaleString([], { year: '2-digit', month: '2-digit', day: '2-digit', hour: '2-digit', minute: '2-digit', hour12: false }).replace(',', '');
                return `
                    <tr class="table-row odd:bg-[#2d3748] even:bg-[#1f2937] hover:bg-gray-700" ondblclick="showSinglePlayerChart('${stat.playerName}')">
                        <td class="text-center"><input type="checkbox" class="form-checkbox h-4 w-4 bg-gray-700 border-gray-600" value="${stat.playerName}" onchange="handleCompareSelect(this)" ${isChecked ? 'checked' : ''} ${isDisabled ? 'disabled' : ''}></td>
                        <td class="font-bold text-center">${stat.rank}</td>
                        <td class="font-semibold text-white">
                            <i class="fas ${specialization.icon} ${specialization.color} mr-2" title="${specialization.title}"></i>
                            ${stat.playerName}
                        </td>
                        ${statCells}
                        <td class="font-bold text-yellow-400">${stat.trueScore.toLocaleString()}</td>
                        <td class="font-bold text-gray-300">${stat.realScore.toLocaleString()}</td>
                        <td class="text-xs text-gray-400">${formattedDate}</td>
                        <td>
                             <button onclick="showHistory('${stat.playerName}')" class="text-indigo-400 hover:text-indigo-300 mr-2 text-xl"><i class="fas fa-history"></i></button>
                             <button onclick="enterEditMode('${stat.id}')" class="text-blue-400 hover:text-blue-300 mr-2 text-xl"><i class="fas fa-pencil-alt"></i></button>
                             <button onclick="deleteStat('${stat.id}', '${stat.playerName}')" class="text-red-400 hover:text-red-300 text-xl"><i class="fas fa-trash-alt"></i></button>
                        </td>
                    </tr>
                `;
            }).join('');
        };
        
        const sortAndRender = () => {
             latestStats.sort((a, b) => {
                const valA = a[currentSort.column];
                const valB = b[currentSort.column];
                let comparison = (typeof valA === 'string') ? valA.localeCompare(valB) : valA - valB;
                return currentSort.direction === 'asc' ? comparison : -comparison;
            });
            renderTable();
        };

        const calculateTrueScore = (stats) => {
            const weights = { lethality: 1.2, hp: 1.1, attack: 1.0, defense: 1.0 };
            let total = 0;
            total += (stats.infAttack + stats.cavAttack + stats.arcAttack) * weights.attack;
            total += (stats.infDefense + stats.cavDefense + stats.arcDefense) * weights.defense;
            total += (stats.infLethality + stats.cavLethality + stats.arcLethality) * weights.lethality;
            total += (stats.infHp + stats.cavHp + stats.arcHp) * weights.hp;
            return Math.round(total);
        };

        const calculateRealScore = (stats) => {
            let total = 0;
            const statKeys = ['infAttack', 'infDefense', 'infLethality', 'infHp', 'cavAttack', 'cavDefense', 'cavLethality', 'cavHp', 'arcAttack', 'arcDefense', 'arcLethality', 'arcHp'];
            statKeys.forEach(key => total += (stats[key] || 0));
            return Math.round(total);
        };
        
        const showModal = (titleKey, messageKey, replacements = {}) => {
            let message = getTranslation(messageKey);
            for(const key in replacements) {
                message = message.replace(`{${key}}`, replacements[key]);
            }
            modalTitle.textContent = getTranslation(titleKey);
            modalMessage.textContent = message;
            modal.classList.remove('hidden');
            return new Promise(resolve => {
                modalConfirmBtn.onclick = () => { modal.classList.add('hidden'); resolve(true); };
                modalCancelBtn.onclick = () => { modal.classList.add('hidden'); resolve(false); };
            });
        };

        window.handleSaveOrUpdate = async () => {
            const statData = getFormData();
            if (!statData.playerName) return;
            try {
                const collectionPath = `artifacts/${appId}/public/data/game_stats`;
                if (currentEditId) {
                    await setDoc(doc(db, collectionPath, currentEditId), { ...statData, date: serverTimestamp() });
                } else {
                    await addDoc(collection(db, collectionPath), { ...statData, date: serverTimestamp() });
                }
                resetForm();
            } catch (error) { showModal('Error', `Failed to save data: ${error.message}`); }
        };

        window.enterEditMode = (docId) => {
            const statToEdit = allStats.find(s => s.id === docId);
            if (!statToEdit) return;
            currentEditId = docId;
            playerNameInput.value = statToEdit.playerName;
            ['infAttack', 'infDefense', 'infLethality', 'infHp', 'cavAttack', 'cavDefense', 'cavLethality', 'cavHp', 'arcAttack', 'arcDefense', 'arcLethality', 'arcHp'].forEach(id => {
                document.getElementById(id).value = statToEdit[id];
            });
            submitBtn.querySelector('span').textContent = getTranslation('update_stats');
            cancelEditBtn.classList.remove('hidden');
            window.scrollTo(0, 0);
        };

        window.resetForm = () => {
            document.querySelector('form').reset();
            currentEditId = null;
            submitBtn.querySelector('span').textContent = getTranslation('save_stats');
            cancelEditBtn.classList.add('hidden');
        };
        window.cancelEdit = resetForm;


        window.deleteStat = async (docId, playerName) => {
            const confirmed = await showModal('confirm_deletion_title', 'confirm_deletion_msg', {playerName});
            if (confirmed) {
                const playerHistory = allStats.filter(s => s.playerName === playerName.toLowerCase());
                for(const stat of playerHistory) {
                    try {
                        await deleteDoc(doc(db, `artifacts/${appId}/public/data/game_stats`, stat.id));
                    } catch (error) {
                        console.error(`Failed to delete doc ${stat.id}`, error);
                    }
                }
            }
        };

        const renderHistoryGraph = (fullHistory, filter) => {
            const canvas = document.getElementById('history-chart-canvas');
            if (!canvas) return;
            
            const now = new Date();
            let cutoffDate = new Date(0); // The beginning of time
            if (filter === '1m') cutoffDate.setMonth(now.getMonth() - 1);
            else if (filter === '3m') cutoffDate.setMonth(now.getMonth() - 3);
            else if (filter === '6m') cutoffDate.setMonth(now.getMonth() - 6);
            else if (filter === '1y') cutoffDate.setFullYear(now.getFullYear() - 1);

            const filteredHistory = fullHistory.filter(stat => stat.date >= cutoffDate).sort((a,b) => a.date - b.date);

            if (historyChart) historyChart.destroy();
            historyChart = new Chart(canvas.getContext('2d'), {
                type: 'line',
                data: {
                    labels: filteredHistory.map(s => s.date.toLocaleDateString()),
                    datasets: [{
                        label: getTranslation('th_real_score'),
                        data: filteredHistory.map(s => s.realScore),
                        borderColor: '#facc15', // yellow-400
                        backgroundColor: 'rgba(250, 204, 21, 0.2)',
                        fill: true,
                        tension: 0.1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { ticks: { color: '#e5e7eb' }, grid: { color: '#374151' } },
                        x: { ticks: { color: '#e5e7eb' }, grid: { color: 'transparent' } }
                    },
                    plugins: { legend: { display: false } }
                }
            });
        };

        window.showHistory = (playerName) => {
            const playerHistory = allStats.filter(s => s.playerName === playerName.toLowerCase()).sort((a,b) => b.date - a.date);
            historyModalTitle.textContent = getTranslation('history_for').replace('{playerName}', playerName);
            historyModalBody.innerHTML = '';
            
            playerHistory.forEach((stat, index) => {
                const prevStat = playerHistory[index + 1];
                let growthHtml = '';
                if(prevStat) {
                    const growth = stat.realScore - prevStat.realScore;
                    const growthColor = growth >= 0 ? 'text-green-400' : 'text-red-400';
                    growthHtml = `<span class="font-bold ${growthColor}">(${growth >= 0 ? '+' : ''}${growth})</span>`;
                }

                const formattedDate = stat.date.toLocaleString();
                const entryDiv = document.createElement('div');
                entryDiv.className = 'p-3 rounded-md border border-gray-700 history-entry';
                entryDiv.innerHTML = `
                    <div class="flex justify-between items-center">
                        <div>
                            <span class="font-semibold">${formattedDate}</span>
                            <div>
                                <span class="text-gray-400">${getTranslation('real_score_label')}</span>
                                <span class="font-bold text-white">${stat.realScore.toLocaleString()}</span>
                                ${growthHtml}
                            </div>
                        </div>
                        <button class="text-sm text-yellow-400 hover:text-yellow-300 ml-4 btn"><i class="fas fa-undo text-lg"></i> ${getTranslation('revert')}</button>
                    </div>
                    <div class="text-xs text-gray-400 grid grid-cols-3 gap-x-4 mt-2 hidden cursor-pointer"></div>
                `;
                entryDiv.querySelector('button').onclick = () => revertToStat(stat.id, stat.playerName);
                
                const mainInfo = entryDiv.querySelector('.flex');
                mainInfo.onclick = (e) => {
                     if (e.target.closest('button')) return; 
                    const detailsDiv = entryDiv.querySelector('.grid');
                    if(detailsDiv.classList.contains('hidden')) {
                        detailsDiv.classList.remove('hidden');
                        detailsDiv.innerHTML = `
                            <div><strong>Inf:</strong> ${stat.infAttack}/${stat.infDefense}/${stat.infLethality}/${stat.infHp}</div>
                            <div><strong>Cav:</strong> ${stat.cavAttack}/${stat.cavDefense}/${stat.cavLethality}/${stat.cavHp}</div>
                            <div><strong>Arc:</strong> ${stat.arcAttack}/${stat.arcDefense}/${stat.arcLethality}/${stat.arcHp}</div>
                        `;
                    } else {
                        detailsDiv.classList.add('hidden');
                    }
                };
                historyModalBody.appendChild(entryDiv);
            });

            historyModal.classList.remove('hidden');
            renderHistoryGraph(playerHistory, 'all');
            document.getElementById('history-time-filter').onchange = (e) => renderHistoryGraph(playerHistory, e.target.value);
        };
        
        historyModalCloseBtn.onclick = () => historyModal.classList.add('hidden');

        window.revertToStat = async (docId, playerName) => {
            const confirmed = await showModal('confirm_revert_title', 'confirm_revert_msg', {playerName});
            if (confirmed) {
                const statToRevert = allStats.find(s => s.id === docId);
                if (!statToRevert) {
                    showModal('Error', 'Could not find the historical data to revert.');
                    return;
                }
                const { id, date, trueScore, realScore, ...newStatData } = statToRevert;
                try {
                    await addDoc(collection(db, `artifacts/${appId}/public/data/game_stats`), { ...newStatData, date: serverTimestamp() });
                    historyModal.classList.add('hidden');
                } catch (error) {
                    showModal('Error', `Failed to revert stats: ${error.message}`);
                }
            }
        };

        const calculateAllianceAverages = () => {
            const statKeys = ['infAttack', 'infDefense', 'infLethality', 'infHp', 'cavAttack', 'cavDefense', 'cavLethality', 'cavHp', 'arcAttack', 'arcDefense', 'arcLethality', 'arcHp'];
            const averages = {};
            statKeys.forEach(k => averages[k] = 0);
            if (latestStats.length === 0) return averages;
            latestStats.forEach(player => statKeys.forEach(key => averages[key] += player[key] || 0));
            statKeys.forEach(key => averages[key] = parseFloat((averages[key] / latestStats.length).toFixed(1)));
            return averages;
        };

        window.showSinglePlayerChart = (playerName) => {
            const playerStat = latestStats.find(s => s.playerName === playerName.toLowerCase());
            if (!playerStat) return;

            const allianceAverages = calculateAllianceAverages();
            chartModalTitle.textContent = `Stat Comparison for ${playerName}`;
            const statKeys = ['infAttack', 'infDefense', 'infLethality', 'infHp', 'cavAttack', 'cavDefense', 'cavLethality', 'cavHp', 'arcAttack', 'arcDefense', 'arcLethality', 'arcHp'];
            const labels = ['Inf Atk', 'Inf Def', 'Inf Let', 'Inf HP', 'Cav Atk', 'Cav Def', 'Cav Let', 'Cav HP', 'Arc Atk', 'Arc Def', 'Arc Let', 'Arc HP'];
            
            const datasets = [{
                label: playerName,
                data: statKeys.map(key => playerStat[key]),
                backgroundColor: 'rgba(59, 130, 246, 0.7)',
                borderColor: 'rgba(59, 130, 246, 1)',
                borderWidth: 1
            }, {
                label: 'Alliance Average',
                data: statKeys.map(key => allianceAverages[key]),
                backgroundColor: 'rgba(107, 114, 128, 0.7)',
                borderColor: 'rgba(107, 114, 128, 1)',
                borderWidth: 1
            }];
            
            const ctx = document.getElementById('comparison-chart-canvas').getContext('2d');
            if (comparisonChart) comparisonChart.destroy();
            comparisonChart = new Chart(ctx, { type: 'bar', data: { labels, datasets }, options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true, ticks: { color: '#e5e7eb' }, grid: { color: '#374151' } }, x: { ticks: { color: '#e5e7eb' }, grid: { color: '#374151' } } }, plugins: { legend: { labels: { color: '#e5e7eb' } } } } });
            chartModal.classList.remove('hidden');
        };
        
        const showComparisonChart = () => {
            if (selectedForComparison.length === 0) return;
            const allianceAverages = calculateAllianceAverages();
            chartModalTitle.textContent = `Comparing ${selectedForComparison.length} players`;
            const statKeys = ['infAttack', 'infDefense', 'infLethality', 'infHp', 'cavAttack', 'cavDefense', 'cavLethality', 'cavHp', 'arcAttack', 'arcDefense', 'arcLethality', 'arcHp'];
            const labels = ['Inf Atk', 'Inf Def', 'Inf Let', 'Inf HP', 'Cav Atk', 'Cav Def', 'Cav Let', 'Cav HP', 'Arc Atk', 'Arc Def', 'Arc Let', 'Arc HP'];
            const playerColors = ['rgba(59, 130, 246, 0.7)', 'rgba(239, 68, 68, 0.7)', 'rgba(245, 158, 11, 0.7)', 'rgba(16, 185, 129, 0.7)', 'rgba(139, 92, 246, 0.7)'];
            const borderColors = ['rgba(59, 130, 246, 1)', 'rgba(239, 68, 68, 1)', 'rgba(245, 158, 11, 1)', 'rgba(16, 185, 129, 1)', 'rgba(139, 92, 246, 1)'];
            
            const datasets = selectedForComparison.map((playerName, index) => {
                const playerStat = latestStats.find(s => s.playerName === playerName);
                return { label: playerName, data: playerStat ? statKeys.map(key => playerStat[key]) : [], backgroundColor: playerColors[index % playerColors.length], borderColor: borderColors[index % borderColors.length], borderWidth: 1 };
            });

            datasets.push({ label: 'Alliance Average', data: statKeys.map(key => allianceAverages[key]), backgroundColor: 'rgba(107, 114, 128, 0.7)', borderColor: 'rgba(107, 114, 128, 1)', borderWidth: 1 });
            
            const ctx = document.getElementById('comparison-chart-canvas').getContext('2d');
            if (comparisonChart) comparisonChart.destroy();
            comparisonChart = new Chart(ctx, { type: 'bar', data: { labels, datasets }, options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true, ticks: { color: '#e5e7eb' }, grid: { color: '#374151' } }, x: { ticks: { color: '#e5e7eb' }, grid: { color: '#374151' } } }, plugins: { legend: { labels: { color: '#e5e7eb' } } } } });
            chartModal.classList.remove('hidden');
        };
        
        compareBtn.onclick = showComparisonChart;
        chartModalCloseBtn.onclick = () => chartModal.classList.add('hidden');

        analyticsBtn.onclick = () => {
            analyticsModalBody.innerHTML = ''; // Clear previous content

            // Section 1: Top Lists
            const rallyLeaders = [...latestStats].sort((a,b) => b.trueScore - a.trueScore).slice(0, 10);
            let rallyHtml = `<div><h4 class="text-lg font-semibold text-yellow-400 mb-2">${getTranslation('top_10_rally')}</h4><ol class="list-decimal list-inside space-y-1">`;
            rallyLeaders.forEach(p => rallyHtml += `<li>${p.playerName} - ${p.trueScore.toLocaleString()}</li>`);
            rallyHtml += '</ol></div>';

            const playerGroups = {};
            allStats.forEach(stat => {
                if (!playerGroups[stat.playerName]) playerGroups[stat.playerName] = [];
                playerGroups[stat.playerName].push(stat);
            });
            const improvements = [];
            for (const name in playerGroups) {
                if(playerGroups[name].length > 1) {
                    const sortedHistory = playerGroups[name].sort((a,b) => b.date - a.date);
                    const improvement = sortedHistory[0].realScore - sortedHistory[1].realScore;
                    if (improvement > 0) improvements.push({ name, improvement });
                }
            }
            const mostImproved = improvements.sort((a,b) => b.improvement - a.improvement).slice(0, 3);
            let improvedHtml = `<div><h4 class="text-lg font-semibold text-green-400 mb-2">${getTranslation('most_improved')}</h4><ol class="list-decimal list-inside space-y-1">`;
             if (mostImproved.length > 0) mostImproved.forEach(p => improvedHtml += `<li>${p.name} <span class="text-green-400 font-bold">(+${p.improvement.toLocaleString()})</span></li>`);
            else improvedHtml += `<li class="italic text-gray-400">${getTranslation('no_history')}</li>`;
            improvedHtml += '</ol></div>';
            
            const topListsContainer = document.createElement('div');
            topListsContainer.className = 'grid grid-cols-1 md:grid-cols-2 gap-6';
            topListsContainer.innerHTML = rallyHtml + improvedHtml;
            analyticsModalBody.appendChild(topListsContainer);
            
            // Section 2: Specialization Breakdown
            const specCounts = { infantry: 0, cavalry: 0, archer: 0, balanced: 0 };
            latestStats.forEach(stat => {
                const spec = getSpecialization(stat);
                specCounts[spec.key]++;
            });

            const breakdownContainer = document.createElement('div');
            breakdownContainer.className = 'grid grid-cols-1 md:grid-cols-2 gap-6 items-center';
            
            const chartContainer = document.createElement('div');
            chartContainer.innerHTML = `<h4 class="text-lg font-semibold text-indigo-400 mb-2">${getTranslation('alliance_comp')}</h4><div class="relative h-64"><canvas id="analytics-chart-canvas"></canvas></div>`;
            breakdownContainer.appendChild(chartContainer);

            // Top players by troop type
            const topByTroopContainer = document.createElement('div');
            const troopTypes = [
                {key: 'inf', name: getTranslation('top_5_inf')}, 
                {key: 'cav', name: getTranslation('top_5_cav')}, 
                {key: 'arc', name: getTranslation('top_5_arc')}
            ];
            let topByTroopHtml = '';
            troopTypes.forEach(type => {
                const topPlayers = [...latestStats].sort((a,b) => (b[`${type.key}Attack`] + b[`${type.key}Defense`] + b[`${type.key}Lethality`] + b[`${type.key}Hp`]) - (a[`${type.key}Attack`] + a[`${type.key}Defense`] + a[`${type.key}Lethality`] + a[`${type.key}Hp`])).slice(0,5);
                topByTroopHtml += `<div class="mb-4"><h5 class="text-md font-semibold text-gray-300 mb-1">${type.name}</h5><ol class="list-decimal list-inside text-sm">`;
                topPlayers.forEach(p => topByTroopHtml += `<li>${p.playerName}</li>`);
                topByTroopHtml += `</ol></div>`;
            });
            topByTroopContainer.innerHTML = topByTroopHtml;
            breakdownContainer.appendChild(topByTroopContainer);
            
            analyticsModalBody.appendChild(breakdownContainer);

            // NEW SECTION: Recent 5 Entries
            const recentEntriesContainer = document.createElement('div');
            const recentEntries = [...allStats].sort((a,b) => b.date - a.date).slice(0, 5);
            let recentHtml = `<div><h4 class="text-lg font-semibold text-cyan-400 mb-2">${getTranslation('last_5_entries')}</h4><ul class="space-y-1 text-sm list-disc list-inside">`;
            if (recentEntries.length > 0) {
                recentEntries.forEach(p => {
                    const formattedDate = p.date.toLocaleString([], { year: '2-digit', month: '2-digit', day: '2-digit', hour: '2-digit', minute: '2-digit' });
                    recentHtml += `<li><span class="font-semibold text-white">${p.playerName}</span> ${getTranslation('submitted_on')} <span class="text-gray-400">${formattedDate}</span></li>`;
                });
            } else {
                recentHtml += `<li class="italic text-gray-400">${getTranslation('no_entries_yet')}</li>`;
            }
            recentHtml += '</ul></div>';
            recentEntriesContainer.innerHTML = recentHtml;
            analyticsModalBody.appendChild(recentEntriesContainer);
            
            analyticsModal.classList.remove('hidden');
            
            // Render Pie Chart
            const ctx = document.getElementById('analytics-chart-canvas').getContext('2d');
            if(analyticsChart) analyticsChart.destroy();
            analyticsChart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: [getTranslation('infantry'), getTranslation('cavalry'), getTranslation('archer'), 'Balanced'],
                    datasets: [{
                        data: [specCounts.infantry, specCounts.cavalry, specCounts.archer, specCounts.balanced],
                        backgroundColor: ['#60a5fa', '#4ade80', '#f87171', '#9ca3af'],
                        borderColor: '#1f2937',
                        borderWidth: 2,
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'top', labels: { color: '#e5e7eb' } }
                    }
                }
            });
        };
        analyticsModalCloseBtn.onclick = () => analyticsModal.classList.add('hidden');


        window.handleCompareSelect = (checkbox) => {
            const playerName = checkbox.value;
            if (checkbox.checked) {
                if(selectedForComparison.length < 5) selectedForComparison.push(playerName);
            } else {
                selectedForComparison = selectedForComparison.filter(p => p !== playerName);
            }
            
            compareCount.textContent = selectedForComparison.length;
            compareBtn.disabled = selectedForComparison.length === 0;
            
            renderTable();
        };
        
        window.sortStats = (column) => {
            if (currentSort.column === column) {
                currentSort.direction = currentSort.direction === 'asc' ? 'desc' : 'asc';
            } else {
                currentSort.column = column;
                currentSort.direction = (['playerName', 'rank'].includes(column)) ? 'asc' : 'desc';
            }
            sortAndRender();
        };
        
        document.querySelectorAll('#language-switcher .flag').forEach(flag => {
            flag.onclick = () => setLanguage(flag.dataset.lang);
        });
        document.getElementById('help-btn').onclick = () => helpModal.classList.remove('hidden');
        document.getElementById('help-modal-close-btn').onclick = () => helpModal.classList.add('hidden');
        document.getElementById('changelog-btn').onclick = () => changelogModal.classList.remove('hidden');
        document.getElementById('changelog-modal-close-btn').onclick = () => changelogModal.classList.add('hidden');

        document.addEventListener('keydown', (event) => {
            if (event.key === 'Escape') {
                helpModal.classList.add('hidden');
                changelogModal.classList.add('hidden');
                historyModal.classList.add('hidden');
                chartModal.classList.add('hidden');
                analyticsModal.classList.add('hidden');
                modal.classList.add('hidden');
            }
        });


        document.addEventListener('DOMContentLoaded', initFirebase);
    </script>
</body>
</html>

